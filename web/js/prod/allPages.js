var gMobileMenuOut=false;var gSliding=false;var gMENU_SLIDE_TIME=.5;$(document).ready(function(){mobileToggleButtonInit();$(window).resize(function(){if(!mobileLayout()){mobileMenuClose()}})});function mobileToggleButtonInit(){var sliderElement=$("#menuSlider");var toggleButton=$("#mobileMenuToggle");toggleButton.on("touchstart click",function(){if(gMobileMenuOut){mobileMenuClose()}else{mobileMenuOpen()}})}function mobileMenuClose(){if(gSliding){return}gSliding=true;var sliderElement=$("#menuSlider");TweenLite.to(sliderElement,gMENU_SLIDE_TIME,{marginTop:0,onComplete:function(){gSliding=false;gMobileMenuOut=false;$("#mobileMenuLinks").hide()}})}function mobileMenuOpen(){if(gSliding){return}var sliderElement=$("#menuSlider");var menuLinksHeight=$("#mobileMenuLinks").outerHeight();$("#mobileMenuLinks").show();gSliding=true;TweenLite.to(sliderElement,gMENU_SLIDE_TIME,{marginTop:menuLinksHeight,onComplete:function(){gSliding=false;gMobileMenuOut=true}})}
var SIDE_BAR_SLIDE_TIME=.5;var gSideBarActive=false;$(document).ready(function(){$("#sideBarToggle").data("shown",false);$("#sideBarToggle").click(sideBarSlideToggle)});function sideBarSlideToggle(){var shown=$("#sideBarToggle").data("shown");if(!shown){menuOpen()}else{menuClose()}}function menuOpen(){var timeline=new TimelineMax;gSideBarActive=true;TweenLite.to("#menuLayout",SIDE_BAR_SLIDE_TIME,{x:-$("#menuLayout").width(),onComplete:function(){$("#sideBarToggle").data("shown",true)}});var translate=$("#menuLayout").width();TweenLite.to("#menuSlider, .menuSlide",SIDE_BAR_SLIDE_TIME,{x:-translate});TweenLite.to("#sideBarToggle",SIDE_BAR_SLIDE_TIME,{rotation:-90,transformOrigin:"50% 50%"})}function menuClose(){TweenLite.to("#menuLayout",SIDE_BAR_SLIDE_TIME,{x:0,onComplete:function(){$("#sideBarToggle").data("shown",false);gSideBarActive=false}});TweenLite.to("#menuSlider, .menuSlide",SIDE_BAR_SLIDE_TIME,{x:0,onComplete:function(){$("#menuSlider, .menuSlide").css("transform","")}});TweenLite.to("#sideBarToggle",SIDE_BAR_SLIDE_TIME,{rotation:0,transformOrigin:"50% 50%"})}
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,function(e){"use strict";function m(e){return Math.round(1e5*e)/1e5||0}var b=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,w=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,Y=Math.PI/180,k=Math.sin,B=Math.cos,F=Math.abs,J=Math.sqrt;function arcToSegment(e,t,n,s,a,r,i,o,h){if(e!==o||t!==h){n=F(n),s=F(s);var u=a%360*Y,f=B(u),c=k(u),l=Math.PI,g=2*l,d=(e-o)/2,m=(t-h)/2,x=f*d+c*m,p=-c*d+f*m,y=x*x,M=p*p,v=y/(n*n)+M/(s*s);1<v&&(n=J(v)*n,s=J(v)*s);var C=n*n,E=s*s,b=(C*E-C*M-E*y)/(C*M+E*y);b<0&&(b=0);var w=(r===i?-1:1)*J(b),P=n*p/s*w,S=-s*x/n*w,N=f*P-c*S+(e+o)/2,D=c*P+f*S+(t+h)/2,T=(x-P)/n,V=(p-S)/s,_=(-x-P)/n,q=(-p-S)/s,A=T*T+V*V,R=(V<0?-1:1)*Math.acos(T/J(A)),G=(T*q-V*_<0?-1:1)*Math.acos((T*_+V*q)/J(A*(_*_+q*q)));isNaN(G)&&(G=l),!i&&0<G?G-=g:i&&G<0&&(G+=g),R%=g,G%=g;var L,O=Math.ceil(F(G)/(g/4)),j=[],z=G/O,I=4/3*k(z/2)/(1+B(z/2)),H=f*n,Q=c*n,Z=c*-s,U=f*s;for(L=0;L<O;L++)x=B(a=R+L*z),p=k(a),T=B(a+=z),V=k(a),j.push(x-I*p,p+I*x,T+I*V,V-I*T,T,V);for(L=0;L<j.length;L+=2)x=j[L],p=j[L+1],j[L]=x*H+p*Z+N,j[L+1]=x*Q+p*U+D;return j[L-2]=o,j[L-1]=h,j}}function stringToRawPath(e){function db(e,t,n,s){f=(n-e)/3,c=(s-t)/3,o.push(e+f,t+c,n-f,s-c,n,s)}var t,n,s,a,r,i,o,h,u,f,c,l,g,d,m,x=(e+"").replace(w,function(e){var t=+e;return t<1e-4&&-1e-4<t?0:t}).match(b)||[],p=[],y=0,M=0,v=x.length,C=0,E="ERROR: malformed path: "+e;if(!e||!isNaN(x[0])||isNaN(x[1]))return console.log(E),p;for(t=0;t<v;t++)if(g=r,isNaN(x[t])?i=(r=x[t].toUpperCase())!==x[t]:t--,s=+x[t+1],a=+x[t+2],i&&(s+=y,a+=M),t||(h=s,u=a),"M"===r)o&&(o.length<8?--p.length:C+=o.length),y=h=s,M=u=a,o=[s,a],p.push(o),t+=2,r="L";else if("C"===r)i||(y=M=0),(o=o||[0,0]).push(s,a,y+1*x[t+3],M+1*x[t+4],y+=1*x[t+5],M+=1*x[t+6]),t+=6;else if("S"===r)f=y,c=M,"C"!==g&&"S"!==g||(f+=y-o[o.length-4],c+=M-o[o.length-3]),i||(y=M=0),o.push(f,c,s,a,y+=1*x[t+3],M+=1*x[t+4]),t+=4;else if("Q"===r)f=y+2/3*(s-y),c=M+2/3*(a-M),i||(y=M=0),y+=1*x[t+3],M+=1*x[t+4],o.push(f,c,y+2/3*(s-y),M+2/3*(a-M),y,M),t+=4;else if("T"===r)f=y-o[o.length-4],c=M-o[o.length-3],o.push(y+f,M+c,s+2/3*(y+1.5*f-s),a+2/3*(M+1.5*c-a),y=s,M=a),t+=2;else if("H"===r)db(y,M,y=s,M),t+=1;else if("V"===r)db(y,M,y,M=s+(i?M-y:0)),t+=1;else if("L"===r||"Z"===r)"Z"===r&&(s=h,a=u,o.closed=!0),("L"===r||.5<F(y-s)||.5<F(M-a))&&(db(y,M,s,a),"L"===r&&(t+=2)),y=s,M=a;else if("A"===r){if(d=x[t+4],m=x[t+5],f=x[t+6],c=x[t+7],n=7,1<d.length&&(d.length<3?(c=f,f=m,n--):(c=m,f=d.substr(2),n-=2),m=d.charAt(1),d=d.charAt(0)),l=arcToSegment(y,M,+x[t+1],+x[t+2],+x[t+3],+d,+m,(i?y:0)+1*f,(i?M:0)+1*c),t+=n,l)for(n=0;n<l.length;n++)o.push(l[n]);y=o[o.length-2],M=o[o.length-1]}else console.log(E);return(t=o.length)<6?(p.pop(),t=0):o[0]===o[t-2]&&o[1]===o[t-1]&&(o.closed=!0),p.totalPoints=C+t,p}function p(){return M||"undefined"!=typeof window&&(M=window.gsap)&&M.registerPlugin&&M}function q(){(M=p())?(M.registerEase("_CE",n.create),a=1):console.warn("Please gsap.registerPlugin(CustomEase)")}function s(e){return~~(1e3*e+(e<0?-.5:.5))/1e3}function x(e,t,n,s,a,r,i,o,h,u,f){var c,l=(e+n)/2,g=(t+s)/2,d=(n+a)/2,m=(s+r)/2,p=(a+i)/2,y=(r+o)/2,M=(l+d)/2,v=(g+m)/2,C=(d+p)/2,E=(m+y)/2,b=(M+C)/2,w=(v+E)/2,P=i-e,S=o-t,N=Math.abs((n-i)*S-(s-o)*P),D=Math.abs((a-i)*S-(r-o)*P);return u||(u=[{x:e,y:t},{x:i,y:o}],f=1),u.splice(f||u.length-1,0,{x:b,y:w}),h*(P*P+S*S)<(N+D)*(N+D)&&(c=u.length,x(e,t,l,g,M,v,b,w,h,u,f),x(b,w,C,E,p,y,i,o,h,u,f+1+(u.length-c))),u}var M,a,t,y=/[-+=\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/gi,v=/[cLlsSaAhHvVtTqQ]/g,n=((t=CustomEase.prototype).setData=function setData(e,t){t=t||{};var n,s,a,r,i,o,h,u,f,c=(e=e||"0,0,1,1").match(y),l=1,g=[],d=[],m=t.precision||1,p=m<=1;if(this.data=e,(v.test(e)||~e.indexOf("M")&&e.indexOf("C")<0)&&(c=stringToRawPath(e)[0]),4===(n=c.length))c.unshift(0,0),c.push(1,1),n=8;else if((n-2)%6)throw"Invalid CustomEase";for(0==+c[0]&&1==+c[n-2]||function _normalize(e,t,n){n||0===n||(n=Math.max(+e[e.length-1],+e[1]));var s,a=-1*e[0],r=-n,i=e.length,o=1/(+e[i-2]+a),h=-t||(Math.abs(e[i-1]-e[1])<.01*(e[i-2]-e[0])?function _findMinimum(e){var t,n=e.length,s=1e20;for(t=1;t<n;t+=6)+e[t]<s&&(s=+e[t]);return s}(e)+r:+e[i-1]+r);for(h=h?1/h:-o,s=0;s<i;s+=2)e[s]=(+e[s]+a)*o,e[s+1]=(+e[s+1]+r)*h}(c,t.height,t.originY),this.segment=c,r=2;r<n;r+=6)s={x:+c[r-2],y:+c[r-1]},a={x:+c[r+4],y:+c[r+5]},g.push(s,a),x(s.x,s.y,+c[r],+c[r+1],+c[r+2],+c[r+3],a.x,a.y,1/(2e5*m),g,g.length-1);for(n=g.length,r=0;r<n;r++)h=g[r],u=g[r-1]||h,h.x>u.x||u.y!==h.y&&u.x===h.x||h===u?(u.cx=h.x-u.x,u.cy=h.y-u.y,u.n=h,u.nx=h.x,p&&1<r&&2<Math.abs(u.cy/u.cx-g[r-2].cy/g[r-2].cx)&&(p=0),u.cx<l&&(u.cx?l=u.cx:(u.cx=.001,r===n-1&&(u.x-=.001,l=Math.min(l,.001),p=0)))):(g.splice(r--,1),n--);if(i=1/(n=1/l+1|0),h=g[o=0],p){for(r=0;r<n;r++)f=r*i,h.nx<f&&(h=g[++o]),s=h.y+(f-h.x)/h.cx*h.cy,d[r]={x:f,cx:i,y:s,cy:0,nx:9},r&&(d[r-1].cy=s-d[r-1].y);d[n-1].cy=g[g.length-1].y-s}else{for(r=0;r<n;r++)h.nx<r*i&&(h=g[++o]),d[r]=h;o<g.length-1&&(d[r-1]=g[g.length-2])}return this.ease=function(e){var t=d[e*n|0]||d[n-1];return t.nx<e&&(t=t.n),t.y+(e-t.x)/t.cx*t.cy},(this.ease.custom=this).id&&M.registerEase(this.id,this.ease),this},t.getSVGData=function getSVGData(e){return CustomEase.getSVGData(this,e)},CustomEase.create=function create(e,t,n){return new CustomEase(e,t,n).ease},CustomEase.register=function register(e){M=e,q()},CustomEase.get=function get(e){return M.parseEase(e)},CustomEase.getSVGData=function getSVGData(e,t){var n,a,r,i,o,h,u,f,c,l,g=(t=t||{}).width||100,d=t.height||100,x=t.x||0,p=(t.y||0)+d,y=M.utils.toArray(t.path)[0];if(t.invert&&(d=-d,p=0),"string"==typeof e&&(e=M.parseEase(e)),e.custom&&(e=e.custom),e instanceof CustomEase)n=function rawPathToString(e){!function _isNumber(e){return"number"==typeof e}(e[0])||(e=[e]);var t,n,s,a,r="",i=e.length;for(n=0;n<i;n++){for(a=e[n],r+="M"+m(a[0])+","+m(a[1])+" C",t=a.length,s=2;s<t;s++)r+=m(a[s++])+","+m(a[s++])+" "+m(a[s++])+","+m(a[s++])+" "+m(a[s++])+","+m(a[s])+" ";a.closed&&(r+="z")}return r}(function transformRawPath(e,t,n,s,a,r,i){for(var o,h,u,f,c,l=e.length;-1<--l;)for(h=(o=e[l]).length,u=0;u<h;u+=2)f=o[u],c=o[u+1],o[u]=f*t+c*s+r,o[u+1]=f*n+c*a+i;return e._dirty=1,e}([e.segment],g,0,0,-d,x,p));else{for(n=[x,p],i=1/(u=Math.max(5,200*(t.precision||1))),f=5/(u+=2),c=s(x+i*g),a=((l=s(p+e(i)*-d))-p)/(c-x),r=2;r<u;r++)o=s(x+r*i*g),h=s(p+e(r*i)*-d),(Math.abs((h-l)/(o-c)-a)>f||r===u-1)&&(n.push(c,l),a=(h-l)/(o-c)),c=o,l=h;n="M"+n.join(",")}return y&&y.setAttribute("d",n),n},CustomEase);function CustomEase(e,t,n){a||q(),this.id=e,this.setData(t,n)}p()&&M.registerPlugin(n),n.version="3.2.6",e.CustomEase=n,e.default=n;if(typeof window==="undefined"||window!==e){Object.defineProperty(e,"__esModule",{value:!0})}else{delete e.default}});
l("Loading util!!!!");$(document).ready(function(){if($(".xdebug-error").length>0){l($(".xdebug-error *").text())}});function browserSupportsFileAPI(){return window.FileReader&&window.File&&window.FileList&&window.Blob}function isLocalHost(){return 0==location.href.indexOf("http://localhost")}function selectInputsValueAttributeUpdateInit(pSelect){pSelect.each(function(){var select=$(this);select.attr("data-value",select.val());select.change(function(){select.attr("data-value",select.val())})})}function stringOrSelectorGet(pStringOrSelector){if(typeof pStringOrSelector=="string"){return $(pStringOrSelector)}return pStringOrSelector}function elementIndexInSelectorGet(pElement,pSelector){var index=-1;pSelector.each(function(pIndex,pComparisonElement){if(pElement.get(0)==pComparisonElement){index=pIndex}});return index}function namedElementValuesSetFromData(pWrapper,pData){$.each(pData,function(pKey,pValue){pWrapper.find("[name="+pKey+"]").val(pValue)})}function dataGetFromNamedElements(pWrapper){var data={};pWrapper.find("[name]").eachElement(function(pElement){data[pElement.attr("name")]=pElement.val()});return data}function elementCloneWithNamedValues(pElement){var clonedElement=pElement.clone();pElement.find("[name]").eachElement(function(pNamedElement){var name=pNamedElement.attr("name");clonedElement.find("[name="+name+"]").val(pNamedElement.val())});return clonedElement}function unitProcess(pValue,pPermittedUnits,pDefaultUnit){var value=null;$.each(pPermittedUnits,function(pIndex,pUnit){if(pUnit.length>pValue.length){return false}if(pValue.substr(pValue.length-pUnit.length)==pUnit){value=pValue;return false}});if(value){return value}return pValue+pDefaultUnit}function readURLs(pInput,pLoadedCallback){if(pInput.files){$.each(pInput.files,function(pIndex,pFile){var reader=new FileReader;reader.onload=function(e){pLoadedCallback(e.target.result,pIndex)};reader.readAsDataURL(pFile)})}}$.fn.eachElement=function(pFunction){this.each(function(){return pFunction($(this))});return this};$.fn.eachIndexAndElement=function(pFunction){this.each(function(pIndex){return pFunction(pIndex,$(this))});return this};function cssValueCopy(pSourceElement,pDestinationElement,pProperty){pDestinationElement.css(pProperty,pSourceElement.css(pProperty))}function elementDimensionsMatch(pSourceElement,pDestinationElement){widthMatch(pSourceElement,pDestinationElement);heightMatch(pSourceElement,pDestinationElement)}function widthMatch(pSourceElement,pDestinationElement){pDestinationElement.width(pSourceElement.width())}function heightMatch(pSourceElement,pDestinationElement){pDestinationElement.height(pSourceElement.height())}function objectCopyToClipboard(pObject){var json=JSON.stringify(pObject);textCopyToClipboard(json)}function objectGetFromClipboard(){var json=clipboardTextGet();if(json){var object=$.parseJSON(json);if(object){return object}}return null}function clipboardClear(){localStorageValueRemove("clipboard")}function textCopyToClipboard(pText){localStorageValueSet("clipboard",pText)}function clipboardTextGet(){return localStorageValueGet("clipboard")}function dp(pParam,pDefault){if(def(pParam)){return pParam}return pDefault}function randomIntegerGet(pMax){return Math.floor(Math.random()*pMax)}(function($){$.fn.shuffle=function(){var allElems=this.get(),getRandom=function(max){return Math.floor(Math.random()*max)},shuffled=$.map(allElems,function(){var random=getRandom(allElems.length),randEl=$(allElems[random]).clone(true)[0];allElems.splice(random,1);return randEl});this.each(function(i){$(this).replaceWith($(shuffled[i]))});return $(shuffled)}})(jQuery);function htmlDecode(pHtml){var doc=$.parseHTML(pHtml);if(doc){return doc[0].textContent}return null}function sessionRefreshInit(){var seconds=$("#sessionLifetime").attr("class");var ms=seconds*1e3;setTimeout(function(){location.reload()},ms)}function selectorGetFromStringOrSelector(pStringOrSelector){if("string"==typeof pStringOrSelector){return $(pStringOrSelector)}return pStringOrSelector}function elementBottom(pSelector){return $(pSelector).offset().top+$(pSelector).outerHeight()}function timeGet(){var date=new Date;return date.getTime()}function elementHasAttribute(pElement,pAttribute){return pElement.is("["+pAttribute+"]")}function backgroundImageUrlGet(pElement){var backgroundImage=pElement.css("background-image");if("none"==backgroundImage){return"none"}backgroundImage=backgroundImage.substr("url(".length);backgroundImage=backgroundImage.substr(0,backgroundImage.length-1);backgroundImage=trim(backgroundImage,'"');return backgroundImage}function trim(s,mask){while(~mask.indexOf(s[0])){s=s.slice(1)}while(~mask.indexOf(s[s.length-1])){s=s.slice(0,-1)}return s}function locationGetFromIP(pSuccess,pFail){$.ajax({dataType:"json",url:"http://freegeoip.net/json/",success:function(pData){pSuccess&&pSuccess(pData)},error:function(){pFail&&pFail()},timeout:3e3})}function tabletAndSmaller(){return $("#mediaMatcher").css("float")!="none"}function tablet(){return $("#mediaMatcher").css("float")=="left"}function mobile(){return $("#mediaMatcher").css("float")=="right"}function screenSizeGet(){if(!tabletAndSmaller()){return"desktop"}else if(tablet()){return"tablet"}else{return"mobile"}}function pageHasVerticalScrollBar(){l("Has Scroll Bar",$("body").width()>$(window).width());l("Win width",$(window).width());l("Doc Width",$(document).width());return $(window).width()<$(document).width()}function elementScrollToCentre(pElement,pAnimate,pAnimDuration){pAnimDuration=dp(pAnimDuration,.5);pAnimate=dp(pAnimate,false);var top=pElement.offset().top;var halfScreenHeight=$(window).height()/2;var halfSuccessMessageHeight=pElement.outerHeight()/2;var scrollTo=top-halfScreenHeight+halfSuccessMessageHeight;if(pAnimate){TweenMax.to(window,{duration:pAnimDuration,scrollTo:scrollTo})}else{$(window).scrollTop(scrollTo)}}function screenDimensionsGet(){return{width:screenWidthGet(),height:screenHeightGet()}}function screenWidthGet(){return $(window).width()}function screenHeightGet(){return $(window).height()}function osIsApple(){return navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?true:false}function osIsAndroid(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("android")>-1}function osIsWindows(){return navigator.platform.indexOf("Win")>-1}var hexDigits=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function rgb2hex(rgb){rgb=rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+hex(rgb[1])+hex(rgb[2])+hex(rgb[3])}function rgba2hex(rgb){rgb=rgb.match(/^rgba\((\d+),\s*(\d+),\s*(\d+)\,\s*(\d+)\)$/);return"#"+hex(rgb[1])+hex(rgb[2])+hex(rgb[3])}function hexToRgb(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]:null}function hex(x){return isNaN(x)?"00":hexDigits[(x-x%16)/16]+hexDigits[x%16]}function translateYGet(pElement){return transformComponentsGet(pElement).y}function transformXGet(pElement){return transformComponentsGet(pElement).x}function transformComponentsGet(pElement){var matrix=pElement.css("transform").replace(/[^0-9\-.,]/g,"").split(",");if(matrix.length<5){return{x:0,y:0}}var x=matrix[12]||matrix[4];var y=matrix[13]||matrix[5];return{x:parseFloat(x),y:parseFloat(y)}}function fixedElementScreenYGet(pElement){var y=0;var translate=translateYGet(pElement);var top=parseFloat(pElement.css("top"));y=translate+top;return y}function localStorageValueSet(pKey,pValue){console.log("Setting "+pKey+" to "+pValue);if(typeof pValue=="boolean"){localStorage[pKey]="bool:"+pValue}else{localStorage[pKey]=pValue}}function localStorageValueGet(pFullKey){if(pFullKey in localStorage){var value=localStorage[pFullKey];if(0==value.indexOf("bool:")){if(-1!=value.indexOf("true")){return true}else{return false}}return localStorage[pFullKey]}return null}function localStorageValueRemove(pFullKey){localStorage.removeItem(pFullKey)}function localStorageValueSetForPage(pKey,pValue){localStorageValueSet(localStoragePageKeyGet(pKey),pValue)}function localStorageValueGetForPage(pKey){return localStorageValueGet(localStoragePageKeyGet(pKey))}function localStorageValueRemoveForPage(pKey){localStorage.removeItem(localStoragePageKeyGet(pKey))}function localStoragePageKeyGet(pKey){return location.pathname+":"+pKey}function domClimbTo(pElement,pTargetSelector){var parent=pElement.parent();if(0==parent.length){return null}if(parent.is(pTargetSelector)){return parent}return domClimbTo(parent,pTargetSelector)}jQuery.fn.domClimbTo=function(pTargetSelector){return domClimbTo(this,pTargetSelector)};jQuery.fn.reverse=[].reverse;function elementIsHidden(pElement){if(pElement.is("body")){return false}if("none"==pElement.css("display")){return true}return elementIsHidden(pElement.parent())}function elementIsInViewport(pElement,pOffsetPercent){var offset=0;if(pOffsetPercent){offset=pOffsetPercent*pElement.outerHeight()}var elementTop=pElement.offset().top;var elementBottom=elementTop+pElement.outerHeight();var screenBottom=$(window).scrollTop()+$(window).height();if(elementTop+offset<screenBottom&&elementBottom-offset>$(window).scrollTop()){return true}return false}function elementIsAboveViewport(pElement,pOffsetPercent){var offset=0;if(pOffsetPercent){offset=pOffsetPercent*pElement.outerHeight()}var elementTop=pElement.offset().top;var elementBottom=elementTop+pElement.outerHeight();var screenBottom=$(window).scrollTop()+$(window).height();l($(window).scrollTop());l(elementBottom);if($(window).scrollTop()>elementTop-offset){return true}return false}function maxInArrayGet(pArray){return Math.max.apply(null,pArray)}function uniqid(){var id="";for(var i=0;i<13;i++){id+=randomHexDigitGet()}return id}function randomHexDigitGet(){var CHARS=["0","1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f"];return CHARS[randomIntegerGet(16)]}function colourPickersInit(){$(".colourPicker, .colourPickerHex").off("change");$(".colourPicker").on("change",function(){var thisVal=$(this).val();var otherVal=$(this).next().val();if(thisVal!=otherVal){$(this).next().val($(this).val())}});$(".colourPickerHex").on("change",function(){var thisVal=$(this).val();var otherVal=$(this).next().val();if(thisVal!=otherVal){$(this).prev().val($(this).val())}})}function browserIsIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(msie>0){return true}var trident=ua.indexOf("Trident/");if(trident>0){var rv=ua.indexOf("rv:");return true}var edge=ua.indexOf("Edge/");if(edge>0){return true}return false}function arrayShuffle(pArray){for(var i=pArray.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=pArray[i];pArray[i]=pArray[j];pArray[j]=temp}return pArray}
var VIDEO_ASPECT_RATIO=.5625;var gPreviousScreenWidth=0;var gPreviousScreenHeight=0;var gPageSearches=0;var gSlideshowTimelines=[];var gElementJSData={};function responsiveBreaksInit(){if($("[data-responsive-break-below]").length==0){return}$("[data-responsive-break-below]").eachElement(function(pElement){pElement.hide();var value=pElement.data("responsive-break-below");var width=parseInt(value);if(isNaN(width)){return true}var mediaQuery=window.matchMedia("(max-width: "+width+"px)");if(mediaQuery.matches){}})}$(document).ready(function(){responsiveBreaksInit();jsDataInit();responsiveInit();videosInit();if("undefined"!=typeof carouselsInit){carouselsInit()}slideshowInit();animatedGradientsInit();if("undefined"!=typeof superCarouselBlocksInit){superCarouselBlocksInit()}clickThroughsInit();facebookRefresh();twitterRefresh();togglesInit();$(window).resize(layoutResize);$(window).scroll(layoutScroll);pageHeightCalculate();loadEventsInit();articleListsInit();dateCountersInit()});function forEachBlock(pBlock,pCallback){$($(".block-"+pBlock)).each(function(pIndex){pCallback($(this))})}function dateCountersInit(){forEachBlock("dateCountdown",function(pBlock){var elementId=pBlock.attr("data-id");var data=gElementData[elementId]["dateCountdown"];setInterval(function(){dateCounterRefresh(pBlock,data)},1e3)})}function dateCounterRefresh(pBlock,pData){var day=pData.day;var month=pData.month-1;var hour=pData.hour;var year=pData.year;var now=new Date;var deadline=new Date(year,month,day,hour);if(deadline>now){var ms=deadline-now}else{var ms=0}ms=Math.max(0,ms);var delta=Math.abs(ms)/1e3;var days=Math.floor(delta/86400);delta-=days*86400;var hours=Math.floor(delta/3600)%24;delta-=hours*3600;var minutes=Math.floor(delta/60)%60;delta-=minutes*60;var seconds=delta%60;pBlock.find(".days").text(days);pBlock.find(".hours").text(hours);pBlock.find(".minutes").text(minutes);pBlock.find(".seconds").text(Math.round(seconds))}function currentLayoutGetAsString(){if(mobileLayout()){return"mobile"}else if(tabletLayout()){return"tablet"}else{return"desktop"}}function articleRowLinkInit(pRowWrapper){if(pRowWrapper.data("article-row-page-link")){pRowWrapper.click(function(){location.href=pRowWrapper.data("article-row-page-link")})}}function articleListsInit(){$(".pseudoRow").remove();$("[data-article-row]").each(function(){articleRowLinkInit($(this))});articleElementsInitialIndexSet();articleElementGroupsTag();articleListsUpdate()}function articleElementsInitialIndexSet(){$("[data-article-element-type]").each(function(){var element=$(this);var mobile=domClimbTo(element,".mobileLayout");if(mobile){var index=elementIndexInSelectorGet(element,$(".mobileSelectable"));element.data("initialElementIndex",index)}else{element.data("initialElementIndex",element.prevAll().length)}})}function articleElementGroupsTag(){$("[data-article-element-type]").each(function(pIndex){var element=$(this);if(element.data("grouped")){return true}var type=element.data("article-element-type");var index=element.data("article-index");var nextElement=nextArticleElementGet(element);var group=element;while(nextElement&&nextElement.data("article-index")==index&&nextElement.data("article-element-type")==type){group=group.add(nextElement);nextElement.data("grouped",true);nextElement=nextArticleElementGet(nextElement)}element.data("group",group)})}function elementIsInMobileLayout(pElement){return null!=domClimbTo(pElement,".mobileLayout")}function nextArticleElementGet(pArticleElement){if(!elementIsInMobileLayout(pArticleElement)){return pArticleElement.next()}var mobileLayoutWrapper=domClimbTo(pArticleElement,".mobileLayout");var articleElementSelector=mobileLayoutWrapper.find("[data-article-element-type]");var index=elementIndexInSelectorGet(pArticleElement,articleElementSelector);var nextIndex=index+1;if(nextIndex<articleElementSelector.length){return articleElementSelector.eq(nextIndex)}return null}function articleRowsUpdate(){currentLayoutSelectorGet().find("[data-article-row]").each(function(){articleRowUpdate($(this))})}function articleElementsUpdate(){currentLayoutSelectorGet().find("[data-article-element-type]").each(function(){articleElementUpdate($(this))})}function articleElementUpdate(pElement){if(pElement.data("grouped")){return}if(pElement.data("nextElementFetched")){return}var articleIndex=pElement.data("article-index");if(-1==articleIndex.indexOf("+")){return}var group=pElement;if(pElement.data("group")){group=pElement.data("group")}articleIndex=parseInt(articleIndex);var lastElement=group.eq(group.length-1);var template=lastElement;if(template.is("a")){template=lastElement.children().eq(0)}var elementTop=template.offset().top;var elementBottom=elementTop+template.outerHeight();var scrollTop=$(window).scrollTop();var screenBottom=$(window).height()+scrollTop;if(elementBottom<screenBottom+$(window).height()){var spinners=$();var firstElement=group.eq(0);firstElement.data("nextElementFetched",true);var lastElement=group.eq(group.length-1);var insertAfter=lastElement;var row=domClimbTo(firstElement,".mobileRowWrapper");if(row){var spacing=pElement.data("article-spacing");var spinner=articleListSpinnerCreate(row,row,spacing);spinners=spinners.add(spinner)}else{group.each(function(pIndex){var element=$(this);var template=element;if(!element.is(".mobileSelectable")){template=element.find(".mobileSelectable")}var spacing=0;if(pIndex==group.length-1){spacing=pElement.data("article-spacing")}var spinner=spinners.add(articleListSpinnerCreate(template,insertAfter,spacing));insertAfter=spinner;spinners=spinners.add(spinner)})}var pageArticleId=$("html").data("article-id");var pageArticleType=$("html").data("article-type");var data={elementScreen:currentLayoutGetAsString(),elementsStartIndex:group.eq(0).data("initialElementIndex"),elementsEndIndex:lastElement.data("initialElementIndex"),articleIndex:articleIndex+1,pageId:pageIdGet(),articleId:pageArticleId,articleType:pageArticleType};$.post("/articleElementsGet",data,function(pResponse){if(""==pResponse){spinners.remove()}else{var parser=new DOMParser;var dom=parser.parseFromString(pResponse,"text/html");var newElements=$(dom).find("[data-article-element-type]");var newColumns=null;if(row){spinners.remove();var clonedRow=row.clone();clonedRow.addClass("clonedRow");newColumns=clonedRow.find(".mobileHalfWidthColumn").empty();row.after(clonedRow)}newElements.each(function(pIndex){var newElement=$(this);var oldElement=group.eq(pIndex);var newElementAndChildren=newElement.find("*").addBack();var newElementSelectable=newElementAndChildren.filter(".mobileSelectable,.selectable");newElementSelectable.attr("id","");newElementSelectable.css("margin-top",0);newElement.data("article-index",articleIndex+1+"+");newElement.data("initialElementIndex",oldElement.data("initialElementIndex"));newElement.attr("style",oldElement.attr("style"));if(0!=pIndex){}else{}if(newElement.is(".mobileSelectable")){newElement.addClass("pseudoElement")}else{newElement.find(".mobileSelectable").addClass("pseudoElement")}newElement.addClass("pseudoElement");newElement.children().addClass("pseudoElement");if(newColumns){newColumns.eq(pIndex).append(newElement)}else{spinners.eq(pIndex).replaceWith(newElement)}if(newElement.find("[data-imageSrc]").length>0){newElement.css("opacity",0);allImagesLoadCheckAll()}else{TweenMax.to(newElement,.5,{opacity:1})}});articleElementGroupsTag();articleElementsUpdate()}})}}function allRootRowWrappersGet(){return currentLayoutSelectorGet().find(".rootRowWrapper").not(".pseudoRow")}function rowWrapperIndexGet(pRowWrapper){return elementIndexInSelectorGet(pRowWrapper,allRootRowWrappersGet())}function articleRowUpdate(pRowWrapper){if(pRowWrapper.hasClass("responsiveHidden")){l("Row hidden - ignoring "+pRowWrapper.attr("id"));return}if(pRowWrapper.hasClass("nextRowFetched")){return}var articleIndex=pRowWrapper.data("article-row-index");if("string"!=typeof articleIndex||-1==articleIndex.indexOf("+")){return}articleIndex=parseInt(articleIndex);if("column"==pRowWrapper.data("article-row-division")){var columns=pRowWrapper.find(".flexColumn").length;articleIndex+=columns}else{articleIndex+=1}var rowTop=pRowWrapper.offset().top;var rowBottom=rowTop+pRowWrapper.height();var scrollTop=$(window).scrollTop();var screenBottom=$(window).height()+scrollTop;if(rowBottom<screenBottom){pRowWrapper.addClass("nextRowFetched");var rowIndex=rowWrapperIndexGet(pRowWrapper);l("rowIndex",rowIndex);var data=pRowWrapper.data("initialRowIndex");if(def(pRowWrapper.data("initialRowIndex"))){rowIndex=pRowWrapper.data("initialRowIndex")}var data={rowScreen:currentLayoutGetAsString(),rowIndex:rowIndex,articleIndex:articleIndex,pageId:pageIdGet()};var pageArticleId=$("html").data("article-id");if(pageArticleId){data["articleId"]=pageArticleId}var spinnerWrapper=articleListSpinnerCreate(pRowWrapper,pRowWrapper,pRowWrapper.data("article-row-bottom-margin"));l("Fetching Article Row ",pRowWrapper.attr("id"));$.post("/articleRowsGet",data,function(pResponse){l("Article Row Fetched",pRowWrapper.attr("id"));if(""==pResponse){pRowWrapper.css("margin-bottom",spinnerWrapper.css("margin-bottom"));spinnerWrapper.remove()}else{var newRow=$(pResponse);newRow.attr("id","");newRow.data("article-row-index",articleIndex+"+");newRow.data("initialRowIndex",rowIndex);newRow.css("opacity",1);newRow.css("margin-top",0);newRow.addClass("pseudoRow");newRow.children(".rootRow").addClass("pseudoRow");newRow.find(".selectedElement").removeClass(".selectedElement");spinnerWrapper.replaceWith(newRow);articleRowLinkInit(newRow);allImagesLoadCheckAll();rowElementEffectsInit(newRow);articleRowsUpdate()}})}}function articleListSpinnerCreate(pTemplateElement,pInsertAfter,pSpacing){var height=pTemplateElement.outerHeight();if(0==height&&pTemplateElement.is("a")){height=pTemplateElement.children().eq(0).outerHeight()}var spinnerWrapper=$('<div style="text-align: center;" class="articleListSpinner">');var icon=$('<i class="fa fa-spinner fa-spin">').appendTo(spinnerWrapper);spinnerWrapper.css("height",height);spinnerWrapper.css("margin-bottom",pTemplateElement.css("margin-bottom"));pTemplateElement.css("margin-bottom",pSpacing);pInsertAfter.after(spinnerWrapper);var top=height/2-icon.height()/2;icon.css("top",height/2-icon.height()/2);return spinnerWrapper}function pageIdGet(){return $("html").attr("id")}function jsDataInit(){gBodyElementJSData=$.parseJSON(gBodyElementJSData);gMenuElementJSData=$.parseJSON(gMenuElementJSData);gFooterElementJSData=$.parseJSON(gFooterElementJSData);jsDataSectionAppend(gBodyElementJSData);jsDataSectionAppend(gMenuElementJSData);jsDataSectionAppend(gFooterElementJSData)}function jsDataSectionAppend(pSectionData){$.each(pSectionData,function(pElementID,pElementData){gElementJSData[pElementID]=pElementData})}function socialRefresh(pReplace){facebookRefresh(pReplace);twitterRefresh(pReplace)}function loadEventsInit(){$(".block-facebook").data("rowLoadEvent",function(){facebookRefresh(false)});$(".block-twitter").data("rowLoadEvent",twitterRefresh)}function videosInit(){videosResize()}function pageHeightCalculate(){if("auto"!=gPageHeight){return}if(!desktopLayout()){desktopPageHeightSet("auto");return}l("pageHeightCalculate");var lastRow=lastRootRowWrapperInDesktopMain();if("fixed"!=lastRow.css("position")){return}var scrollPos=0;gPageSearches=0;var scrollPos=pageHeightSearch(0,1e3);scrollPos=pageHeightSearch(scrollPos,500);scrollPos=pageHeightSearch(scrollPos,100);scrollPos=pageHeightSearch(scrollPos,10);scrollPos=pageHeightSearch(scrollPos,1);l("Found scroll pos in "+gPageSearches+" attempts");desktopPageHeightSet(scrollPos+$(window).height());rowScrollingUpdate()}function pageHeightSearch(pStartScrollPos,pIncrement){while(pStartScrollPos<1e4){gPageSearches++;if(lastRowIsInViewAtScrollPos(pStartScrollPos)){return pStartScrollPos-pIncrement}pStartScrollPos+=pIncrement}return pStartScrollPos-pIncrement}function lastRootRowWrapperInDesktopMain(){return $("#bodyInner .desktopLayout .rootRowWrapper").last()}function desktopPageHeightSet(pHeight){l("***Setting page height",pHeight);l($("#bodyInner .desktopLayout").css("height"));$("#bodyInner .desktopLayout").css("height",pHeight)}function desktopPageHeightGet(){return $("#bodyInner .desktopLayout").height()}function allRootRowWrappersSelectorGet(){return currentLayoutSelectorGet().find(".rootRowWrapper")}function lastRowIsInViewAtScrollPos(pScrollPos){$("html, body").css("scrollTop",pScrollPos);rowScrollingUpdate(pScrollPos);var screenHeight=$(window).height();var lastRow=lastRootRowWrapperInDesktopMain();var bottom=rowScreenBottomGet(lastRow);var footerHeight=$("#menuSlider footer").outerHeight();if(bottom<=screenHeight+footerHeight){return true}return false}function rowScreenBottomGet(pRowWrapper){if(pRowWrapper.css("position")=="fixed"){return parseFloat(pRowWrapper.css("top"))+translateYGet(pRowWrapper)+pRowWrapper.outerHeight(true)}else{l("To do - rowScreenBottomGet for non fixed element")}}function backgroundParallaxUpdate(){var scrollTop=$(window).scrollTop();var screenHeight=$(window).height();var screenBottom=scrollTop+screenHeight;currentLayoutSelectorGet().find("[data-background-parallax-velocity]").each(function(){var row=$(this);if(!row.data("initialBackgroundPositionY")){var y=row.css("background-position-y");if("undefined"==typeof y){y="0%"}row.data("initialBackgroundPositionY",y)}var rowTop=row.offset().top;var rowHeight=row.outerHeight();var rowBottom=rowTop+rowHeight;var initialY=row.data("initialBackgroundPositionY");if(rowTop<screenBottom){var velocity=row.data("background-parallax-velocity");var rowEntryPoint=rowTop-screenHeight;rowEntryPoint=Math.max(0,rowEntryPoint);var rowExitPoint=rowBottom;var scrollTopMax=$(document).height()-screenHeight;rowExitPoint=Math.min(scrollTopMax,rowExitPoint);var progressInPx=scrollTop-rowEntryPoint;var progressFraction=progressInPx/(rowExitPoint-rowEntryPoint);var backgroundSize=row.css("background-size");if(-1!=backgroundSize.indexOf("%")&&parseFloat(backgroundSize)<100){}if(velocity<0){var invertedFraction=1-progressFraction*-velocity;var backgroundY=Math.round(invertedFraction*100)}else{var backgroundY=Math.round(progressFraction*100*velocity)}var offset=backgroundPositionConvertToNumber(initialY);if(-1!=offset.indexOf("%")){backgroundY+=parseFloat(offset)}else{var percentage=parseFloat(offset)/rowHeight*100;backgroundY+=percentage}TweenLite.set(row,{backgroundPositionY:backgroundY+"%"})}})}function parallaxPauseCallbacksTrigger(pRowWrapper){pRowWrapper.find("*").each(function(){var element=$(this);if(element.data("parallaxPauseCallbacksTrigger")){element.data("parallaxPauseCallbacksTrigger")();element.removeData("parallaxPauseCallbacksTrigger")}})}function parallaxRowYTranslationGetFromScrollTop(pRowWrapper,pScrollTop){var screenHeight=$(window).height();var initialTop=pRowWrapper.data("row-top");if("string"!=typeof initialTop){initialTop=initialTop.toString()}var pauseAt=pRowWrapper.data("row-pause-at");var velocity=pRowWrapper.data("row-parallax-velocity");var scrollTopMax=$("#bodyInner").outerHeight()-screenHeight;var progressFraction=pScrollTop/scrollTopMax;var displacementInPx=progressFraction*velocity*scrollTopMax;if(-1!=initialTop.indexOf("vh")||-1!=initialTop.indexOf("%")){var startPosInPx=parseFloat(initialTop)*screenHeight/100}else{var startPosInPx=parseFloat(initialTop)}pRowWrapper.data("top",startPosInPx);pRowWrapper.data("transformY",displacementInPx);var actualScreenPosInPx=startPosInPx+displacementInPx;var pauseTriggered=false;if("undefined"!==typeof pauseAt){if(pauseAt.toString().indexOf("px")!=-1){var pauseAtInPx=parseFloat(pauseAt)}else{var pauseAtInPx=parseFloat(pauseAt)*screenHeight/100}var diff=actualScreenPosInPx-pauseAtInPx;if(velocity>0&&diff>0){displacementInPx=displacementInPx-diff;pauseTriggered=true}else if(velocity<0&&diff<0){displacementInPx=displacementInPx-diff;pauseTriggered=true}}return{pauseTriggered:pauseTriggered,yTranslation:displacementInPx}}var rows=null;function rowScrollingUpdate(pSimulatedScrollTop){backgroundParallaxUpdate();if(mobileLayout()){return}var scrollTop=$(window).scrollTop();if("undefined"!=typeof pSimulatedScrollTop){scrollTop=pSimulatedScrollTop}if(!rows){rows=$(".rootRowWrapper")}rows.data("paused",false);rows.each(function(){var first=false;var second=false;var rowWrapper=$(this);var pausePointTriggered=false;var pauseAt=rowWrapper.data("row-pause-at");if(domClimbTo(rowWrapper,".desktopLayout")){}if(rowWrapper.attr("id")==="mainDesktopRowWrapper0"){first=true}if(rowWrapper.attr("id")==="mainDesktopRowWrapper1"){second=true}if(rowWrapper.is("[data-attached-to-row]")){var attachedToRow=attachedRowWrapperGet(rowWrapper);if(attachedToRow){var newY=0;var pauseWithAttached=rowWrapper.data("row-pause-with-attached");if(attachedToRow.data("paused")&&"no"===pauseWithAttached){var height=0;var chainData=attachedRowChainDataGet(rowWrapper,height);if(second){l(chainData)}var topRowTop=0;if(rowIsParallax(chainData.topRow)){topRowTop=chainData.topRow.data("top")}else{topRowTop=elementTopRelativeToScreenGet(chainData.topRow,scrollTop)}newY=topRowTop+rowYTranslateGet(chainData.topRow)+chainData.totalHeight;if(second){l(1)}}else{var attachedToRowBottom=elementBottomRelativeToScreenGet(attachedToRow,scrollTop);if(second){}var translateY=rowYTranslateGet(attachedToRow);if(second){}var cumulativeAttachedToRowBottom=attachedToRowBottom+translateY;newY=cumulativeAttachedToRowBottom;if(attachedToRow.data("paused")){rowWrapper.data("paused",true)}if(second){}}if("undefined"!==typeof pauseAt){var screenHeight=$(window).height();var pauseAtInPx=0;if(pauseAt.toString().indexOf("px")!=-1){pauseAtInPx=parseFloat(pauseAt)}else{pauseAtInPx=parseFloat(pauseAt)*screenHeight/100}var diff=newY-pauseAtInPx;var topRowData=attachedRowChainDataGet(rowWrapper);var topRow=topRowData.topRow;var velocity=topRow.data("row-parallax-velocity");if("undefined"==typeof velocity){velocity=-1}if(velocity>0&&diff>0){pausePointTriggered=true}else if(velocity<0&&diff<0){pausePointTriggered=true}if(pausePointTriggered){newY=pauseAtInPx}}elementScreenYSetUsingTransform(rowWrapper,newY)}}else if(rowWrapper.is("[data-row-parallax-velocity]")){var data=parallaxRowYTranslationGetFromScrollTop(rowWrapper,scrollTop);pausePointTriggered=data.pauseTriggered;TweenLite.set(rowWrapper,{y:data.yTranslation});rowWrapper.data("yTranslate",data.yTranslation)}if(pausePointTriggered){rowWrapper.data("paused",true);parallaxPauseCallbacksTrigger(rowWrapper)}})}function rowYTranslateGet(pRow){if(pRow.data("yTranslate")){return pRow.data("yTranslate")}return translateYGet(pRow)}function elementScreenYSetUsingTransform(pElement,pScreenY){var yTransform=pScreenY-elementTopInPixelsGet(pElement);TweenLite.set(pElement,{y:yTransform,z:1});pElement.data("yTranslate",yTransform)}function elementTopInPixelsGet(pElement){var top=pElement.css("top");var topInPx=parseFloat(top);return topInPx}function elementTopRelativeToScreenGet(pElement,pSimulatedScrollTop,pIncludeMargin){if("fixed"==pElement.css("position")){return parseFloat(pElement.css("top"))+parseFloat(pElement.css("margin-top"))}var scrollTop=$(window).scrollTop();if("undefined"!=typeof pSimulatedScrollTop){scrollTop=pSimulatedScrollTop}var top=pElement.offset().top-scrollTop;if(pIncludeMargin){top-=parseFloat(pElement.css("margin-top"))}return top}function rowIsParallax(pRowWrapper){var velocity=pRowWrapper.data("row-parallax-velocity");return"fixed"==pRowWrapper.css("position")&&velocity&&0!=velocity}function elementBottomRelativeToScreenGet(pElement,pSimulatedScrollTop){return elementTopRelativeToScreenGet(pElement,pSimulatedScrollTop)+pElement.outerHeight()+parseFloat(pElement.css("margin-bottom"))}function attachedRowChainDataGet(pRowWrapper){var data=attachedRowChainDataGetRecursive(pRowWrapper);if(!data){return null}data.totalHeight=data.totalHeight-parseFloat(data.topRow.css("margin-top"));return data}function attachedRowChainDataGetRecursive(pRowWrapper,pHeight){if(!pHeight){pHeight=0}var attachedToRow=attachedRowWrapperGet(pRowWrapper);if(!attachedToRow){return null}pHeight+=attachedToRow.outerHeight(true);var attachedToAttachedToRow=attachedRowWrapperGet(attachedToRow);if(attachedToAttachedToRow){return attachedRowChainDataGetRecursive(attachedToRow,pHeight)}return{topRow:attachedToRow,totalHeight:pHeight}}function attachedRowWrapperGet(pRowWrapper){var attachedToRowName=pRowWrapper.data("attached-to-row");attachedToRowWrapper=$('[data-row-name="'+attachedToRowName+'"]');if(attachedToRowWrapper.length>0){return attachedToRowWrapper}return null}function backgroundPositionConvertToNumber(pPosition){if("center"==pPosition){return"50%"}else if("top"==pPosition){return"0%"}else if("bottom"==pPosition){return"100%"}return pPosition}function editorIsActive(){return typeof gEditorLoaded!=="undefined"}function togglesInit(){$("[class]").each(function(){var element=$(this);var classAttr=element.attr("class");if(!classAttr){return true}var classes=classAttr.split(" ");$.each(classes,function(pIndex,pClass){if(-1!=pClass.indexOf("toggle-")){var targetClass=pClass.substr(7);var targetElement=$("."+targetClass);if(targetElement.length>0){var elementAndDescendants=element.find("*");elementAndDescendants.addClass("clickable");if(!editorIsActive()){var url=location.href;var hide=true;if(-1!=url.indexOf("#")){var parts=url.split("#");var linkSelector="#"+parts[parts.length-1];if(targetClass==parts[parts.length-1]){hide=false}}if(hide){targetElement.hide()}}elementAndDescendants.click(function(){targetElement.css("opacity",1);targetElement.slideToggle();return false})}}})})}var gLastScrollTime=0;function layoutScroll(){gLastScrollTime=Date.now();rowScrollingUpdate();articleListsUpdate()}function articleListsUpdate(){articleRowsUpdate();articleElementsUpdate()}function timeSinceLastScrollMsGet(){return Date.now()-gLastScrollTime}function formFocus(pFocusWhenNotSubmittedDesktop,pFocusWhenNotSubmittedMobile,pAnimate){var animate=dp(pAnimate,true);var successOrErrorMessage=currentLayoutSelectorGet().find(".successMessage,form .has-error");if(!editorLoaded()&&successOrErrorMessage.length){elementScrollToCentre(successOrErrorMessage.eq(0),animate)}else{if(desktopLayout()){pFocusWhenNotSubmittedDesktop&&firstInputFocus()}else{pFocusWhenNotSubmittedMobile&&firstInputFocus()}}}function formFileFieldSizeConstraintInit(pForm){if(!browserSupportsFileAPI()){return}pForm.find("input[type=file]").change(function(){var input=$(this);var maxSize=input.data("max-file-size");if(maxSize){if("M"==maxSize.substr(maxSize.length-1)){var maxSizeInBytes=parseInt(maxSize)*1e6;var errorMessage="Sorry this file was too large. It should be less than "+maxSize+"B.";input.parent().find(".fileTooLargeMessage").remove();if(this.files[0].size>maxSizeInBytes){input.after('<div class="fileTooLargeMessage">'+errorMessage+"</div>");input.val("")}}}})}function firstInputFocus(){var clickableElements="input, select, button, textarea";currentLayoutSelectorGet().find(clickableElements).eq(0).focus()}function formSubmitted(){return currentLayoutSelectorGet().find(".successMessage").length}function clickThroughsInit(){$(".clickThrough").on("click touchstart",function(pEvent){var clickedElement=$(this);var elementBehind=inputBehindGet(pEvent,clickedElement);if(elementBehind){if(elementBehind.is("button,input[type=checkbox]")){var form=domClimbTo(elementBehind,"form");elementBehind.trigger(pEvent.type)}else{elementBehind.focus()}}});$(".clickThrough").mousemove(function(pEvent){var element=$(this);clickThroughCursorCheck(pEvent,element)})}function clickThroughCursorCheck(pEvent,pElement){var clickableElements="input, select, button, textarea, label";var inputBehind=inputBehindGet(pEvent,pElement);if(inputBehind.is(clickableElements)){if(inputBehind.is("button,input[type=checkbox]")){pElement.css("cursor","pointer");inputBehind.addClass("clickThroughHover");console.log(pElement.attr("class"))}else{pElement.css("cursor","text");$(".clickThroughHover").removeClass("clickThroughHover")}}else{pElement.css("cursor","default");$(".clickThroughHover").removeClass("clickThroughHover")}}function inputBehindGet(pEvent,pElement){console.log(pElement.attr("class"));var rowWrapper=domClimbTo(pElement,".rowWrapper");if(!rowWrapper){rowWrapper=pElement}rowWrapper.hide();if("touchstart"==pEvent.type){pEvent=pEvent.originalEvent.touches[0]}var elementBehind=$(document.elementFromPoint(pEvent.clientX,pEvent.clientY));rowWrapper.show();if(elementBehind.length==0){return null}return elementBehind}function animatedGradientsInit(){$("[data-animatedGradientColours]").each(function(){var element=$(this);var coloursAttribute=element.attr("data-animatedGradientColours");var colours=$.parseJSON(coloursAttribute);if(colours.length<4){return true}element.data("animatedGradientStep",0);element.data("animatedGradientIndices",[0,1,2,3]);if(element.data("interval")){clearInterval(interval)}var interval=setInterval(function(){updateGradient(element)},10);element.data("interval",interval)})}function updateGradient(pElement){var step=pElement.data("animatedGradientStep");var colourIndices=pElement.data("animatedGradientIndices");var coloursAttribute=pElement.attr("data-animatedGradientColours");var speedAttribute=pElement.attr("data-animatedGradientSpeed");var gradientSpeed=parseFloat(speedAttribute)/1e3;var hexColours=$.parseJSON(coloursAttribute);var rgbaColours=[];$.each(hexColours,function(pIndex,pColour){var rgbColour=hexToRgb(pColour);rgbaColours.push(rgbColour)});if(!colourIndices){return}var c0_0=rgbaColours[colourIndices[0]];var c0_1=rgbaColours[colourIndices[1]];var c1_0=rgbaColours[colourIndices[2]];var c1_1=rgbaColours[colourIndices[3]];var istep=1-step;var r1=Math.round(istep*c0_0[0]+step*c0_1[0]);var g1=Math.round(istep*c0_0[1]+step*c0_1[1]);var b1=Math.round(istep*c0_0[2]+step*c0_1[2]);var color1="rgb("+r1+","+g1+","+b1+")";var r2=Math.round(istep*c1_0[0]+step*c1_1[0]);var g2=Math.round(istep*c1_0[1]+step*c1_1[1]);var b2=Math.round(istep*c1_0[2]+step*c1_1[2]);var color2="rgb("+r2+","+g2+","+b2+")";pElement.css({background:"-webkit-gradient(linear, left top, right top, from("+color1+"), to("+color2+"))"}).css({background:"-moz-linear-gradient(left, "+color1+" 0%, "+color2+" 100%)"}).css({background:"linear-gradient(to right, "+color1+" 0%, "+color2+" 100%)"});step+=gradientSpeed;if(step>=1){step%=1;colourIndices[0]=colourIndices[1];colourIndices[2]=colourIndices[3];colourIndices[1]=(colourIndices[1]+Math.floor(1+Math.random()*(rgbaColours.length-1)))%rgbaColours.length;colourIndices[3]=(colourIndices[3]+Math.floor(1+Math.random()*(rgbaColours.length-1)))%rgbaColours.length}pElement.data("animatedGradientStep",step);pElement.data("animatedGradientIndices",colourIndices)}function flexSet(pElement,pFlexValue){pElement.css("flex",pFlexValue);pElement.css("-webkit-box-flex",pFlexValue);pElement.css("-moz-box-flex",pFlexValue);pElement.css("-webkit-flex",pFlexValue);pElement.css("-ms-flex",pFlexValue)}function layoutResize(){l("Layout Resize");if($(window).width()==gPreviousScreenWidth&&$(window).height()==gPreviousScreenHeight){return}gPreviousScreenWidth=$(window).width();gPreviousScreenHeight=$(window).height();responsiveBreaksInit();responsiveRefresh();videosResize();facebookRefresh(true);twitterRefresh(true);if("undefined"!=typeof superCarouselsResize){superCarouselsResize()}if("undefined"!=typeof carouselReset){carouselReset()}pageHeightCalculate();rolloversRefreshIfPresent();articleListsUpdate();setTimeout(function(){twitterRefresh(true);allImagesLoadCheckAll()},0)}function rolloversRefreshIfPresent(){if(typeof rolloversRefresh!=="undefined"){rolloversRefresh()}}function responsiveInit(){$(".flexRow").each(function(){var row=$(this);var firstColumn=row.find(".flexColumn");var margin=firstColumn.css("margin-right");row.data("originalMargin",firstColumn.css("margin-right"))});responsiveRefresh()}function responsiveHidePartsGet(pElement){if(pElement.data("hideParts")){return pElement.data("hideParts")}var part=htmlDecode(pElement.attr("data-hide"));var hideParts=part.split(",");pElement.data("hideParts",hideParts);return hideParts}function responsiveRefresh(){l("responsiveRefresh");$("[data-hide]").each(function(){var element=$(this);var screenWidth=$(window).width();var hideParts=responsiveHidePartsGet(element);elementShowResponsive(element);$.each(hideParts,function(pIndex,pPart){pPart=pPart.trim();if("<="==pPart.substr(0,2)){var number=pPart.substr(2);if(screenWidth<=number){elementHideResponsive(element)}else{}}else if("<"==pPart.substr(0,1)){var number=pPart.substr(1);if(screenWidth<number){elementHideResponsive(element)}else{}}else if(">="==pPart.substr(0,2)){var number=pPart.substr(2);if(screenWidth>=number){elementHideResponsive(element)}else{}}else if(">"==pPart.substr(0,1)){var number=pPart.substr(1);if(screenWidth>number){elementHideResponsive(element)}else{}}})});rowMarginsRefresh()}function elementShowResponsive(pElement){if(!pElement.hasClass("responsiveHidden")){return}pElement.removeClass("responsiveHidden");originalDisplayStore(pElement);var display=pElement.data("originalDisplay");pElement.css("display",display);pElement.find(".layoutSquare").data("responsiveHidden",false);if(pElement.is(".flexColumn")){var rowWrapper=domClimbTo(pElement,".rowWrapper");rowWrapper.removeData("FADE_STATE")}}function originalDisplayStore(pElement){var originalDisplay=pElement.data("originalDisplay");if(!originalDisplay){pElement.data("originalDisplay",pElement.css("display"))}}function elementHideResponsive(pElement){if(pElement.hasClass("responsiveHidden")){return}pElement.addClass("responsiveHidden");originalDisplayStore(pElement);pElement.css("display","none");pElement.data("responsiveHidden",true);pElement.find(".layoutSquare").data("responsiveHidden",true)}function rowMarginsRefresh(){$(".flexRow").each(function(){var row=$(this);var columns=row.children();if(columns.length<=1){return true}columns.each(function(pIndex,pColumn){var column=$(this);var margin=row.data("originalMargin");if(0==pIndex){column.css("margin-right",margin)}else if(columns.length-1==pIndex){column.css("margin-left",margin)}else{column.css("margin-left",margin);column.css("margin-right",margin)}})})}function currentLayoutSelectorGet(){var layoutRoot=$("#bodyInner");if("footer-edit"==gPageId){layoutRoot=$("footer")}else if("menu-edit"==gPageId){layoutRoot=$("#menuLayout")}return layoutRoot.find(layoutSelectorClassSelectorStringGet())}function footerLayoutSelectorGet(){return $("footer").find(layoutSelectorClassSelectorStringGet())}function menuLayoutSelectorGet(){return $("#menuLayout").find(layoutSelectorClassSelectorStringGet())}function layoutSelectorClassSelectorStringGet(){if(mobileLayout()){return".mobileLayout"}else if(tabletLayout()){return".tabletLayout"}return".desktopLayout"}function layoutGetAsString(){if(mobileLayout()){return"mobile"}else if(tabletLayout()){return"tablet"}return"desktop"}function mobileLayout(){return"right"==$("#layoutMediaQuery").css("float")}function desktopLayout(){return"left"==$("#layoutMediaQuery").css("float")}function tabletLayout(){return"none"==$("#layoutMediaQuery").css("float")}function slideshowInit(){if(browserIsIE()){}$.each(gSlideshowTimelines,function(pIndex,pTimeline){pTimeline.kill()});gSlideshowTimelines=[];setTimeout(function(){$(".block-slideshow").each(function(){var block=$(this);nextSlideshowImageAnimateRecursive(block,block.find(".slideShowImage").last(),true)})},3e3)}function slideShowImageChangeCallbackRegister(pBlock,pCallback){pBlock.data("slideShowImageChangeCallback",pCallback)}function nextSlideshowImageAnimateRecursive(pBlock,pImage,pFirst){var elementId=pBlock.attr("data-id");var data=gElementData[elementId];var interval=data.interval;var scaleLower=data.slideshowScaleLower;var scaleUpper=data.slideshowScaleUpper;var diff=scaleUpper-scaleLower;var scaleMiddle=scaleLower+diff/3;var timeline=new TimelineLite;gSlideshowTimelines.push(timeline);var callback=function(){var prevImage=pImage.prev();if(pBlock.data("slideShowImageChangeCallback")){pBlock.data("slideShowImageChangeCallback")(prevImage)}if(!prevImage.is("script")){prevImage.css("opacity",1);nextSlideshowImageAnimateRecursive(pBlock,prevImage,false)}};if(pFirst){if(browserIsIE()){timeline.to(pImage,interval*.9,{onComplete:callback})}else{timeline.to(pImage,interval*.9,{scale:scaleUpper,rotation:.01,onComplete:callback,ease:Power0.easeNone})}}else{if(browserIsIE()){timeline.to(pImage,interval*.9,{onComplete:callback})}else{timeline.to(pImage,interval*.1,{scale:scaleMiddle,rotation:.01,ease:Power0.easeNone});timeline.to(pImage,interval*.8,{scale:scaleUpper,rotation:.01,ease:Power0.easeNone,onComplete:callback})}}var opacityTransition=.1;if(browserIsIE()){opacityTransition=.5}timeline.to(pImage,interval*opacityTransition,{opacity:0,onComplete:function(){pBlock.find("script").after(pImage);TweenLite.set(pImage,{scale:scaleLower,rotation:.01})}})}function twitterRefresh(pReplace){var twitterBlocks=currentLayoutSelectorGet().find(".block-twitter");twitterBlocks.each(function(){var block=$(this);if(!pReplace&&block.find("iframe").length>0){return}var data=elementDataGet(block);if(!data.user){return}var borderContainer=block.find(".blockBorderContainer");if("fit"==data.height){var height=block.height()-borderContainer.outerHeight();var html='<a data-height="'+height+'" class="twitter-timeline" href="https://twitter.com/'+data.user+'"></a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>'}else if(-1!=data.height.indexOf("t")){var html='<a data-tweet-limit="'+parseInt(data.height)+'" class="twitter-timeline" href="https://twitter.com/'+data.user+'"></a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>'}else if(""!=data.height&&0!=data.height){var html='<a data-height="'+data.height+'" class="twitter-timeline" href="https://twitter.com/'+data.user+'"></a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>'}else{var html='<a data-tweet-limit="6" class="twitter-timeline" href="https://twitter.com/'+data.user+'"></a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>'}borderContainer.empty();borderContainer.html(html)})}function elementDataGet(pElement){var elementId=pElement.attr("data-id");if(elementId in gElementData){return gElementData[elementId]}return null}function facebookRefresh(pReplace){var facebookBlocks=currentLayoutSelectorGet().find(".block-facebook");facebookBlocks.each(function(){var block=$(this);if(!pReplace&&block.find("iframe").length>0){return}var column=domClimbTo(block,".flexColumn");var data=elementDataGet(block);if(!data){return}var urlEnd=data.url;if(""==urlEnd){return}block.empty();var width=parseInt(block.innerWidth());width=Math.min(width,500);var height=500;if(column){var heightPercentage=parseFloat(data.height);if(!isNaN(heightPercentage)){height=column.height()*heightPercentage/100}}height=parseInt(height);var baseUrl="https://www.facebook.com/plugins/page.php";var params="href=https%3A%2F%2Fwww.facebook.com%2F"+urlEnd+"&width="+width+"&height="+height+"&tabs=timeline&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true";var widthAttr='width="'+width+'" ';var heightAttr='height="'+height+'" ';var attr=widthAttr+heightAttr+'style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"';var iframe=$('<iframe src="'+baseUrl+"?"+params+'" '+attr+"></iframe>");block.append(iframe);iframe.data("currentWidth",width);iframe.data("currentHeight",height)})}function videosResize(){l("videoResizeStart",$(window).width());$(".block-vimeo, .block-youtube").find(".videoWrapper.crop").each(function(){var wrapper=$(this);var iframe=wrapper.find("iframe");wrapper.css("overflow","hidden");wrapper.css("position","relative");iframe.css("position","absolute");var elementWidth=wrapper.width();var elementHeight=wrapper.height();var videoWidth=elementWidth;var videoHeight=elementWidth*VIDEO_ASPECT_RATIO;if(videoHeight<elementHeight){videoHeight=elementHeight;videoWidth=videoHeight/VIDEO_ASPECT_RATIO}if(videoWidth>elementWidth){var left=-(videoWidth-elementWidth)/2;iframe.css("left",left);console.log("h adjust");console.log("width="+videoWidth)}else if(videoHeight>elementHeight){console.log("v adjust");console.log("height="+videoHeight);iframe.css("left",0)}iframe.width(videoWidth).height(videoHeight)});l("videoResizeEnd",$(window).width())}function elementGetFromId(pId){var element=$("[data-id="+pId+"]");if(element.length>0){return element}return null}function deviceisDesktop(){return $("html").is(".desktop")}function elementIsInDesktopLayout(pElement){return null!=domClimbTo(pElement,".desktopLayout")}
gEASES={easeIn:"power1.in",easeOut:"power1.out",easeInOut:"power1.inOut",back:"back.inOut(1.7)",elastic:"elastic.inOut(1, 0.3)",bounce:"bounce.inOut",rough:"rough({ template: none.out, strength: 1, points: 20, taper: 'none', randomize: true, clamp: false})",slowMo:"slow(0.7, 0.7, false)",stepped:"steps(12)",none:"none"};gEFFECTS={all:{name:"All",fields:[{name:"split",type:"select",default:"no",options:["no","chars","words","lines"]},{name:"order",type:"select",default:"Forwards",options:["Forwards","Backwards","Random","Middle to Ends","Ends to Middle"]},{name:"duration",type:"text",default:1},{name:"interval",type:"text",default:.1},{name:"ease",type:"select",default:"easeIn",options:Object.keys(gEASES)}]},custom:{name:"Custom",init:customTextEffectInit,start:customTextEffectStart,fields:[{name:"x",type:"text",default:0,abilities:["sequence","random"]},{name:"y",type:"text",default:0,abilities:["sequence","random"]},{name:"z",type:"text",default:0,abilities:["sequence","random"]},{name:"scaleX",type:"text",default:1},{name:"scaleY",type:"text",default:""},{name:"opacity",type:"text",default:0},{name:"rotateX",type:"text",default:0,abilities:["sequence","random"]},{name:"rotateY",type:"text",default:0,abilipties:["sequence","random"]},{name:"rotateZ",type:"text",default:0,abilities:["sequence","random"]}]},slideReveal:{name:"Slide Reveal",init:slideRevealTextEffectInit,start:slideRevealTextEffectStart,fields:[{name:"opacity",type:"text",default:0},{name:"direction",type:"select",default:"left",options:["left","right","top","bottom"]},{name:"lineHeight",type:"text",default:""},{name:"edges",type:"select",default:"text",options:["element","text"]}]}};$(document).ready(function(){allTextEffectsInit();textEffectTriggersProcess()});function allTextEffectsInViewCheck(){$("[data-text-effect-data]").each(function(){var textElement=$(this);var data=textEffectDataGetFromElement(textElement);if("inView"==data.trigger){if(elementIsInViewport(textElement)&&!textElement.data("textEffectTriggered")){textElementEffectStart(textElement);textElement.data("textEffectTriggered",true)}}})}function textEffectTriggersProcess(){$("[data-text-effect-data]").each(function(){var textElement=$(this);var data=textEffectDataGetFromElement(textElement);if("load"==data.trigger){textElementEffectStart(textElement)}else if("inView"==data.trigger){textElementInViewEffectTriggerInit(textElement)}else if("rowPause"==data.trigger){textElementRowPauseTriggerInit(textElement)}})}function textElementRowPauseTriggerInit(pTextElement){pTextElement.data("parallaxPauseCallbacksTrigger",function(){textElementEffectStart(pTextElement)})}function textElementInViewEffectTriggerInit(pTextElement){textElementInViewCheck(pTextElement);$(window).scroll(function(){textElementInViewCheck(pTextElement)})}function textElementInViewCheck(pTextElement){if(elementIsInViewport(pTextElement)){console.log("In View")}else{console.log("Out of View")}if(elementIsInViewport(pTextElement)&&!pTextElement.data("textEffectTriggered")){textElementEffectStart(pTextElement);pTextElement.data("textEffectTriggered",true)}}function allTextEffectsInitThenStart(){allTextEffectsInit();allTextEffectsStart()}function elementTextEffectsInitThenStart(pElement){elementTextEffectsInit(pElement);elementTextEffectsStart(pElement)}function elementTextEffectsInit(pElement){pElement.find("[data-text-effect-data]").each(function(){textEffectInit($(this))})}function elementTextEffectsStart(pElement){pElement.find("[data-text-effect-data]").each(function(){textElementEffectStart($(this))})}function textEffectInit(pTextElement,pData){textEffectReset(pTextElement);if(!pData){pData=textEffectDataGetFromElement(pTextElement)}var elements=elementTextEffectSplit(pTextElement,pData);$.each(elements,function(pIndex){if(pData.id in gEFFECTS){gEFFECTS[pData.id].init($(this),pData,pIndex,elements.length)}})}function customTextEffectInitialPropertiesGet(pData,pIndex,pElementCount){var properties={x:textEffectValueCalculate(pData.x,pIndex,pElementCount),y:textEffectValueCalculate(pData.y,pIndex,pElementCount),z:textEffectValueCalculate(pData.z,pIndex,pElementCount),scaleX:textEffectValueCalculate(pData.scaleX,pIndex,pElementCount),scaleY:textEffectValueCalculate(pData.scaleY,pIndex,pElementCount),opacity:textEffectValueCalculate(pData.opacity,pIndex,pElementCount),rotationX:textEffectValueCalculate(pData.rotateX,pIndex,pElementCount),rotationY:textEffectValueCalculate(pData.rotateY,pIndex,pElementCount),rotationZ:textEffectValueCalculate(pData.rotateZ,pIndex,pElementCount)};if(""==pData.scaleY){properties.scaleY=properties.scaleX}return properties}function slideRevealTextEffectInit(pTextElement,pData,pIndex,pElementCount){var text=pTextElement.html();pTextElement.empty();var newTextElement=$('<div class="slideRevealText">').text(text);newTextElement.css("opacity",pData.opacity);if("text"==pData.edges){var justifiedOverflowElement=$("<div>");justifiedOverflowElement.css("display","inline-block");justifiedOverflowElement.css("overflow","hidden");justifiedOverflowElement.append(newTextElement);pTextElement.append(justifiedOverflowElement)}else{pTextElement.append(newTextElement);pTextElement.css("overflow","hidden");pTextElement.append(newTextElement)}if(""!=pData.lineHeight){newTextElement.css("line-height",pData.lineHeight+"px")}var properties={};if("left"==pData.direction){properties["x"]="-100%"}else if("right"==pData.direction){properties["x"]="100%"}else if("top"==pData.direction){properties["y"]="-100%"}else if("bottom"==pData.direction){properties["y"]="100%"}TweenMax.set(newTextElement,properties)}function slideRevealTextEffectStart(pElement,pData,pIgnoreDelay){textEffectStaggerStart(pElement,pElement.find(".slideRevealText").toArray(),pData,slideRevealTextEffectFinalPropertiesGet,pIgnoreDelay)}function slideRevealTextEffectFinalPropertiesGet(pData){return{x:"0%",y:"0%",opacity:1,ease:easeGet(pData)}}function customTextEffectInit(pTextElement,pData,pIndex,pElementCount){TweenMax.set(pTextElement,customTextEffectInitialPropertiesGet(pData,pIndex,pElementCount))}function customTextEffectStart(pElement,pData,pIgnoreDelay){TweenMax.set(pElement,{perspective:500});textEffectStaggerStart(pElement,pElement.data("splitText")[pData.split],pData,customTextEffectFinalPropertiesGet,pIgnoreDelay)}function allTextEffectsInit(){$("[data-text-effect-data]").each(function(){textEffectInit($(this))})}function textEffectDataGetFromElement(pElement){var data=pElement.data("text-effect-data");data=htmlDecode(data);data=$.parseJSON(data);return data}function allTextEffectsStart(){$("[data-text-effect-data]").each(function(){textElementEffectStart($(this))})}function textEffectReset(pTextElement){var previousSplitText=pTextElement.data("splitText");if(previousSplitText){previousSplitText.revert();pTextElement.removeData("splitText")}pTextElement.css("opacity",1)}function elementTextEffectSplit(pElement,pData){if(!pData){pData=textEffectDataGetFromElement(pElement)}if("no"!=pData.split){var splitText=new SplitText(pElement,{type:pData.split});pElement.data("splitText",splitText);return splitText[pData.split]}var newElement=$("<div>").text(pElement.text());newElement.css("display","inline-block");pElement.empty();pElement.append(newElement);var fakeSplitText={no:newElement,revert:function(){var text=newElement.text();pElement.empty();pElement.text(text)}};pElement.data("splitText",fakeSplitText);return[newElement]}function textElementEffectStart(pElement,pData,pIgnoreDelay){if(!pData){pData=textEffectDataGetFromElement(pElement)}if(!(pData.id in gEFFECTS)){return}var effectInfo=gEFFECTS[pData.id];effectInfo.start(pElement,pData,pIgnoreDelay)}function elementsOrder(pData,pElements){if("Backwards"==pData.order){pElements=pElements.reverse()}else if("Random"==pData.order){pElements=arrayShuffle(pElements)}}function textEffectStaggerStart(pParent,pElements,pData,pFinalPropertiesGetter,pIgnoreDelay){if(pIgnoreDelay){pData.delay=0}else{pData.delay=parseFloat(pData.delay)}pData.interval=parseFloat(pData.interval);var interval=parseFloat(pData.interval);if("Backwards"==pData.order){pElements=pElements.reverse()}else if("Random"==pData.order){pElements=arrayShuffle(pElements)}else if("Middle to Ends"==pData.order){if($.isArray(pElements)&&pElements.length>=2){var middleIndex=Math.floor(pElements.length/2);var startArray=[];var endArray=[];var startTimelinesAt=pData.delay;if(1==pElements.length%2){var timelineMax=new TimelineMax({delay:pData.delay});timelineMax.to(pElements[middleIndex],parseFloat(pData.duration),pFinalPropertiesGetter(pData));var startStartIndex=middleIndex-1;var endStartIndex=middleIndex+1;pData.delay+=pData.interval}else{var startStartIndex=middleIndex-1;var endStartIndex=middleIndex}for(var i=startStartIndex;i>=0;i--){startArray.push(pElements[i])}for(var i=endStartIndex;i<pElements.length;i++){endArray.push(pElements[i])}textEffectStaggeredTimelineCreate(pParent,startArray,pData,pFinalPropertiesGetter);textEffectStaggeredTimelineCreate(pParent,endArray,pData,pFinalPropertiesGetter);return}}else if("Ends to Middle"==pData.order){if($.isArray(pElements)&&pElements.length>=2){var middleIndex=Math.floor(pElements.length/2);var startArray=[];var endArray=[];for(i=0;i<middleIndex;i++){startArray.push(pElements[i])}for(i=pElements.length-1;i>=middleIndex;i--){endArray.push(pElements[i])}textEffectStaggeredTimelineCreate(pParent,startArray,pData,pFinalPropertiesGetter);textEffectStaggeredTimelineCreate(pParent,endArray,pData,pFinalPropertiesGetter);return}}textEffectStaggeredTimelineCreate(pParent,pElements,pData,pFinalPropertiesGetter)}function textEffectStaggeredTimelineCreate(pParent,pElements,pData,pFinalPropertiesGetter){var timeline=new TimelineMax({onComplete:function(){}});var time=parseFloat(pData.delay);$.each(pElements,function(pIndex,pElement){timeline.to(pElement,parseFloat(pData.duration),pFinalPropertiesGetter(pData),time);time+=parseFloat(pData.interval)})}function textEffectValueCalculate(pValue,pIndex,pElementCount){if(-1!=pValue.indexOf("r")){var values=pValue.split("r");if(2==values.length){var lowerValue=parseFloat(values[0]);var higherValue=parseFloat(values[1]);var diff=higherValue-lowerValue;var value=Math.random()*diff+lowerValue;return value}}else if(-1!=pValue.indexOf("s")){var values=pValue.split("s");if(2==values.length){var lowerValue=parseFloat(values[0]);var higherValue=parseFloat(values[1]);var diff=higherValue-lowerValue;var fraction=pIndex/(pElementCount-1);var value=lowerValue+fraction*diff;return value}}else if(-1!=pValue.indexOf(",")){var values=pValue.split(",");var valueIndex=0;for(var i=0;i<pElementCount;i++){if(i==pIndex){return values[valueIndex]}valueIndex+=1;if(valueIndex>=values.length){valueIndex=0}}}return pValue}function customTextEffectFinalPropertiesGet(pData){return{ease:easeGet(pData),x:0,y:0,z:0,scaleX:1,scaleY:1,opacity:1,rotationX:0,rotationY:0,rotationZ:0}}function easeGet(pData){if(pData.ease in gEASES){return gEASES[pData.ease]}return null}
var gElementEffects={};var ADDITIONAL_PROPERTIES_MAP={rotationX:["transformOrigin"],rotationY:["transformOrigin"],rotationZ:["transformOrigin"]};var ADDITIONAL_EASE_PROPERTIES_MAP={wiggle:["wiggles","wiggleEase"]};$(document).ready(function(){l("Element effects init");allElementEffectsInit()});function rowElementEffectsInit(pRow){elementEffectsInitForContainer(pRow)}function allElementEffectsInit(){gElementEffects={};if("object"!=typeof gAnimTriggerPresets){gAnimTriggerPresets=$.parseJSON(gAnimTriggerPresets)}$.each(gElementJSData,function(pElementId,pData){if("elementEffects"in pData){gElementEffects[pElementId]=pData.elementEffects}});elementEffectsInitForContainer($("body"))}function elementEffectsInitForContainer(pContainer){$.each(gElementEffects,function(pID,pEffectData){var element=pContainer.find("[data-id="+pID+"]");if(element.data("initialized")){return true}element.data("initialized",true);elementEffectsPresetsProcess(pEffectData);elementEffectTriggersInit(element,pEffectData)})}function elementEffectsRefresh(){l("elementEffectTriggersRefresh");$.each(gElementEffects,function(pID,pEffectData){var element=$("[data-id="+pID+"]");if(element.data("initialized")){elementEffectTriggersRefresh(element,pEffectData);return true}else{l("Element effects not yet initialized")}})}function elementEffectTriggersRefresh(pAnimElement,pTriggers){$.each(pTriggers,function(pIndex,pTriggerData){var event=pTriggerData.properties.event;var triggerElements=triggerElementsGet(pAnimElement,pTriggerData);if(!triggerElements){l("Null trigger elements");return true}if(0==triggerElements.length){l("No trigger elements");return true}triggerElements.each(function(){var triggerElement=$(this);pTriggerData.element=triggerElement;if("inView"==event){elementEffectInViewCheck(pAnimElement,triggerElement,pTriggerData)}})})}function elementEffectsPresetsProcess(pEffects){$.each(pEffects,function(pIndex,pEffect){if("string"==typeof pEffect){if(pEffect in gAnimTriggerPresets){pEffects[pIndex]=JSON.parse(JSON.stringify(gAnimTriggerPresets[pEffect]))}else{pEffects.splice(pIndex,1);l("Anim preset not found - out of sync with other site version?")}}})}function hasElementOpacityEffect(pElement){var id=pElement.data("id");if(id in gElementEffects){var effects=gElementEffects[id];for(var i in effects){var effect=effects[i];if("element"==effect.element&&"opacity"==effect.property){return true}}}else{}return false}function elementEffectTriggersInit(pAnimElement,pTriggers){$.each(pTriggers,function(pIndex,pTriggerData){var event=pTriggerData.properties.event;var triggerElements=triggerElementsGet(pAnimElement,pTriggerData);if(!triggerElements){l("Null trigger elements");return true}if(0==triggerElements.length){l("No trigger elements");return true}triggerElements.each(function(){var triggerElement=$(this);pTriggerData.element=triggerElement;if("rollover"==event){rolloverElementEffectsInit(pAnimElement,pTriggerData)}if("load"==event){elementEffectsTimelinesCreate(pAnimElement,pTriggerData,false)}if("inView"==event){inViewElementEffectsInit(pAnimElement,triggerElement,pTriggerData)}if("click"==event){clickElementEffectsInit(pAnimElement,triggerElement,pTriggerData)}if("clickToggle"==event){clickToggleElementEffectsInit(pAnimElement,triggerElement,pTriggerData)}})})}function triggerElementsGet(pAnimElement,pTrigger){var element=pTrigger.properties.element;var part=pTrigger.properties.elementPart;var triggerElement=pAnimElement;if("elementAbove"==element){triggerElement=pAnimElement.prev()}else if("elementBelow"==element){triggerElement=pAnimElement.next()}else if("this"!=element){triggerElement=$("#"+element)}if("column"==part){var column=domClimbTo(triggerElement,".flexColumn");if(column){return column}}else if("row"==part){var rowWrapper=domClimbTo(triggerElement,".rowWrapper");if(rowWrapper){return rowWrapper}}else if("element"==part){return triggerElement}else if("image"==part){return triggerElement.find(".fluidHeightRowImage,.backgroundImage")}else if(0==part.indexOf("linksInText")){var index=part.substr("linksInText".length);return triggerElement.find(".textPart").eq(index).find("a")}else if(0==part.indexOf("text")){var index=part.substr("text".length);return triggerElement.find(".textPart").eq(index)}else if("multipleLinks"==part){return triggerElement.find("a")}return triggerElement}function clickElementEffectsInit(pElement,pTriggerElement,pTriggerData){var timelines=elementEffectsTimelinesCreate(pElement,pTriggerData,true,false);pTriggerElement.click(function(){timelines.main.restart(true);$.each(timelines.infinite,function(pIndex,pTimeline){pTimeline.restart(true)})})}function clickToggleOtherTimelinesInGroupReverse(pTriggerData,pElement){if("group"in pTriggerData.timelineProperties){var group=pTriggerData.timelineProperties.group;$.each(gElementEffects,function(pElementId,pTriggers){if(pElementId==pElement.data("id")){l("ignoring "+pElementId);return true}$.each(pTriggers,function(pIndex,pTrigger){if(!("group"in pTrigger.timelineProperties)){return true}if(group!=pTrigger.timelineProperties.group){return true}if("clickToggle"!=pTrigger.properties.event){return true}if(!("timelines"in pTrigger)){return true}$.each(pTrigger.timelines,function(pIndex,pTimelines){var element=elementGetFromId(pElementId);if(element.data("effectActive")){l(pElementId+" active")}else{l(pElementId+" inactive")}if(element.data("effectActive")){element.data("effectActive",false);l(pElementId+" reversed");pTimelines.main.reverse();$.each(pTimelines.infinite,function(pIndex,pTimeline){pTimeline.reverse()})}})})})}}function clickToggleElementEffectsInit(pAnimateElement,pTriggerElement,pTriggerData){var timelines=elementEffectsTimelinesCreate(pAnimateElement,pTriggerData,true,true);pAnimateElement.data("effectActive",false);pTriggerElement.click(function(){triggerElementClicked(pAnimateElement,timelines,pTriggerData)});if(pAnimateElement.hasClass("clickToggleOpen")){setTimeout(function(){triggerElementClicked(pAnimateElement,timelines,pTriggerData)},0)}}function triggerElementClicked(pAnimateElement,timelines,pTriggerData){var active=!pAnimateElement.data("effectActive");l("toggle clicked on "+pAnimateElement.data("id")+" "+active);pAnimateElement.data("effectActive",active);if(active){timelines.main.restart(true);$.each(timelines.infinite,function(pIndex,pTimeline){pTimeline.restart(true)});clickToggleOtherTimelinesInGroupReverse(pTriggerData,pAnimateElement)}else{timelines.main.reverse();$.each(timelines.infinite,function(pIndex,pTimeline){pTimeline.reverse()})}}function inViewElementEffectsInit(pAnimElement,pTriggerElement,pTrigger){elementEffectInViewCheck(pAnimElement,pTriggerElement,pTrigger);$(window).scroll(function(){elementEffectInViewCheck(pAnimElement,pTriggerElement,pTrigger)})}function elementEffectInViewCheck(pAnimElement,pTriggerElement,pTriggerData){if(elementIsInViewport(pTriggerElement)&&!pTriggerElement.data("elementEffectTriggered")){elementEffectsTimelinesCreate(pAnimElement,pTriggerData,false,false);pTriggerElement.data("elementEffectTriggered",true)}}function rolloverElementEffectsInit(pElement,pTriggerData){var timelines=elementEffectsTimelinesCreate(pElement,pTriggerData,true,true);pTriggerData.element.hover(function(){timelines.main.play();pElement.data("effectActive",true);$.each(timelines.infinite,function(pIndex,pTimeline){pTimeline.restart(true)})},function(){timelines.main.reverse();$.each(timelines.infinite,function(pIndex,pTimeline){pTimeline.reverse()})})}function additionalTweenPropertiesGet(pEffect,pProperty){var properties={};if(pProperty in ADDITIONAL_PROPERTIES_MAP){$.each(ADDITIONAL_PROPERTIES_MAP[pProperty],function(pIndex,pProperty){if(pProperty in pEffect){properties[pProperty]=pEffect[pProperty]}})}return properties}function setTextAddToTimeline(pTimeline,pElement,pEffect){pTimeline.add(function(){pElement.text(pEffect.setText)},pEffect.delay)}function addRemoveAddToTimeline(pTimeline,pElement,pEffect){var originalDisplay=pElement.css("display");pTimeline.add(function(){if("add"==pEffect.addRemove){pElement.css("display",originalDisplay)}else{pElement.css("display","none")}},pEffect.delay)}function swapTextAddToTimeline(pTimeline,pElement,pEffect){var rootElement=domClimbTo(pElement,".layoutSquare");if(-1==pEffect.swapText.indexOf("text")){return}if(!rootElement){return}var textIndex=pEffect.swapText.substr(4);var swapWithElement=rootElement.find(".textPart").eq(textIndex);var originalDisplayElement=pElement.css("display");var originalDisplaySwapWith=pElement.css("display");pTimeline.add(function(){if("none"==pElement.css("display")){pElement.css("display",originalDisplayElement);swapWithElement.css("display","none")}else{pElement.css("display","none");swapWithElement.css("display",originalDisplaySwapWith)}},pEffect.delay)}function animationsOrder(pAnims){pAnims.sort(function(pA,pB){if(""==pA.duration&&""!=pB.duration){return 1}if(""!=pA.duration&&""==pB.duration){return-1}return 0})}function inlineElementCheck(pProperty,pElement){if(-1!=pProperty.indexOf("scale")||-1!=pProperty.indexOf("rotation")||-1!=pProperty.indexOf("skew")||"x"==pProperty||"y"==pProperty||"z"==pProperty){if("inline"==pElement.css("display")){pElement.css("display","inline-block")}}}function elementEffectsTimelinesCreate(pElement,pTriggerData,pPaused,pRepeatControlled){var mainTimelineProperties={paused:pPaused,repeat:parseInt(pTriggerData.timelineProperties.repeat),delay:parseFloat(pTriggerData.timelineProperties.delay),repeatDelay:parseFloat(pTriggerData.timelineProperties.repeatDelay)};var mainTimeline=new TimelineMax(mainTimelineProperties);var infiniteTimelines=[];opacityCombineWithColourProperty(pElement,pTriggerData.effects);var lastFinish=0;animationsOrder(pTriggerData.effects);pTriggerData.timelines=[];$.each(pTriggerData.effects,function(pIndex,pEffect){var property=pEffect.property;var applyToElement=effectElementGetForProperty(pElement,property,pEffect.element,pTriggerData.element);if(applyToElement.length==0){l("Anim not found for element"+pElement.data("id"));return true}inlineElementCheck(property,applyToElement);if(0===pEffect.duration){pEffect.duration=.001}if(0===pEffect.delay){pEffect.delay=.001}if(""==pEffect.duration){pEffect.duration=mainTimeline.duration()-parseFloat(pEffect.delay)}if("setText"==pEffect.property){setTextAddToTimeline(mainTimeline,applyToElement,pEffect);return true}else if("addRemove"==pEffect.property){addRemoveAddToTimeline(mainTimeline,applyToElement,pEffect);return true}else if("swapText"==pEffect.property){swapTextAddToTimeline(mainTimeline,applyToElement,pEffect);return true}var tweenProperties=elementEffectPropertyAndValueProcessForTween(property,pEffect[property]);$.extend(tweenProperties,additionalTweenPropertiesGet(pEffect,property));if("z"==pEffect.property||"rotationY"==pEffect.property){TweenMax.set(applyToElement.parent(),{perspective:500})}if("opacity"==property&&pElement.hasClass("opacityZeroRemove")){pElement.removeClass("opacityZero");applyToElement.css("opacity",1)}if(isFilterProperty(property)){filterInitialValueSet(property,applyToElement);tweenProperties.autoRound=false}tweenProperties.ease=gEASES[pEffect.ease];var elementOuter=domClimbTo(applyToElement,".layoutSquare");if(elementOuter&&elementOuter.hasClass("overflowHidden")&&0==property.indexOf("scale")){tweenProperties.force3D=false}if(pEffect.delay===""){var delay=lastFinish}else{var delay=pEffect.delay}lastFinish+=parseFloat(pEffect.duration);if(-1==pEffect.repeat){var timelineProperties={yoyo:true,delay:pEffect.delay};if(pPaused){timelineProperties.paused=true}if(pRepeatControlled){timelineProperties.onComplete=function(){this.reverse()};timelineProperties.onReverseComplete=function(){if(pElement.data("effectActive")){this.play()}}}else{timelineProperties.repeat=-1}var timeline=new TimelineMax(timelineProperties);elementEffectTweenAddToTimeline(applyToElement,timeline,tweenProperties,pEffect,0);infiniteTimelines.push(timeline)}else{if(0!=pEffect.repeat){tweenProperties.repeat=parseInt(pEffect.repeat);tweenProperties.yoyo=true}elementEffectTweenAddToTimeline(applyToElement,mainTimeline,tweenProperties,pEffect,delay)}});pTriggerData.timelines.push({main:mainTimeline,infinite:infiniteTimelines});return{main:mainTimeline,infinite:infiniteTimelines}}var gBounceID=0;function squashBounceTweensAddToTimeline(pElement,pTimeline,pTweenProperties,pEffect,pDelay){var id="bounce"+gBounceID;CustomBounce.create(id,{squash:3,strength:.8});pTweenProperties.ease=id;var squashTweenProperties={scaleX:1.5,scaleY:.5,transformOrigin:"bottom",ease:id+"-squash"};if("from"==pEffect.fromTo){pTimeline.from(pElement,pEffect.duration,pTweenProperties,pDelay);pTimeline.to(pElement,pEffect.duration,squashTweenProperties,pDelay)}else{pTimeline.to(pElement,pEffect.duration,pTweenProperties,pDelay);pTimeline.to(pElement,pEffect.duration,squashTweenProperties,pDelay)}gBounceID++;return}function wiggleTweensAddToTimeline(pElement,pTimeline,pTweenProperties,pEffect,pDelay){var ease=CustomWiggle.create("wiggle",{wiggles:pEffect.wiggles,type:pEffect.wiggleEase});pTweenProperties.ease=ease;if("from"==pEffect.fromTo){pTimeline.from(pElement,pEffect.duration,pTweenProperties,pDelay)}else{pTimeline.to(pElement,pEffect.duration,pTweenProperties,pDelay)}return}function elementEffectTweenAddToTimeline(pElement,pTimeline,pTweenProperties,pEffect,pDelay){pEffect.duration=parseFloat(pEffect.duration);if("squashBounce"==pEffect.ease){squashBounceTweensAddToTimeline(pElement,pTimeline,pTweenProperties,pEffect,pDelay);return}else if("wiggle"==pEffect.ease){wiggleTweensAddToTimeline(pElement,pTimeline,pTweenProperties,pEffect,pDelay);return}if("to"==pEffect.fromTo){pTimeline.to(pElement,parseFloat(pEffect.duration),pTweenProperties,parseFloat(pDelay))}else{pTimeline.from(pElement,pEffect.duration,pTweenProperties,pDelay)}}function propertyEffectGetFromArray(pEffects,pProperty){for(var i in pEffects){var effect=pEffects[i];if(pProperty==effect.property){return effect}}return null}function opacityCombineWithColourProperty(pElement,pEffects){$.each(pEffects,function(pIndex,pEffect){if("colourOpacity"in pEffect){var colourValue=pEffect[pEffect.property];if(0==colourValue.indexOf("#")){var rgb=hexToRgb(colourValue);rgb.push(pEffect.colourOpacity);pEffects[pIndex][pEffect.property]="rgba("+rgb.join(",")+")"}}})}function effectElementGetForProperty(pElement,pProperty,pElementField,pTriggerElement){var selector="";var textProperties=["textColour","fontSize"];var svgProperties=["svgFillColour","svgStrokeColour"];var elementAndChildren=pElement.add(pElement.find("*"));var borderContainer=elementAndChildren.filter(".borderContainer,.blockBorderContainer,.mobileSelectable");var mainImage=borderContainer.find(".fluidHeightRowImage,.backgroundImage,.inlineSVGImage");if("allText"==pElementField){return pElement.find(".textPart")}else if(-1!=pElementField.indexOf("text")){var index=pElementField.substr(4);return pElement.find(".textPart").eq(index)}else if(-1!=pElementField.indexOf("linksInText")){var index=pElementField.substr("linksInText".length);return pElement.find(".textPart").eq(index).find("a")}else if(-1!=$.inArray(pProperty,svgProperties)){return mainImage.find("path")}else if("image"==pElementField&&mainImage.length>0){return mainImage}else if("triggerElement"==pElementField){return pTriggerElement}else if(-1!=$.inArray(pProperty,textProperties)){return pElement.find(".textPart")}return borderContainer}function elementEffectPropertyAndValueProcessForTween(pProperty,pValue){var property=pProperty;var value=pValue;var PROPERTY_MAP={backgroundColour:"backgroundColor",borderRadius:"borderRadius",borderRadiusTopLeft:"borderTopLeftRadius",borderRadiusTopRight:"borderTopRightRadius",borderRadiusBottomLeft:"borderBottomLeftRadius",borderRadiusBottomRight:"borderBottomRightRadius",borderColour:"borderColor",textColour:"color",svgStrokeColour:"stroke",svgFillColour:"fill"};var VALUE_UNIT_MAP={borderWidth:[["px"],"px"],borderRadius:[["px"],"px"],borderRadiusTopLeft:[["px"],"px"],borderRadiusTopRight:[["px"],"px"],borderRadiusBottomLeft:[["px"],"px"],borderRadiusBottomRight:[["px"],"px"],filterBlur:[["px"],"px"],filterBrightness:[["%"],"%"],filterContrast:[["%"],"%"],filterGrayScale:[["%"],"%"],"filterHue-Rotate":[["deg"],"deg"],filterInvert:[["%"],"%"],filterSaturate:[["%"],"%"],filterSepia:[["%"],"%"]};if(pProperty in PROPERTY_MAP){property=PROPERTY_MAP[pProperty]}if(pProperty in VALUE_UNIT_MAP){var units=VALUE_UNIT_MAP[pProperty];value=unitProcess(pValue,units[0],units[1])}if(isFilterProperty(pProperty)){return filterTweenPropertyObjectGet(pProperty,value)}var propertyObject={};propertyObject[property]=value;return propertyObject}function isFilterProperty(pProperty){return"filter"==pProperty.substr(0,6)}function filterTweenPropertyObjectGet(pProperty,pValue){var value=pProperty.substr(6).toLowerCase()+"("+pValue+")";var returnObject={};var filterProperty=cssPropertyAvailablePrefixFind("filter");returnObject[filterProperty]=value;return returnObject}function cssPropertyAvailablePrefixFind(pProperty){var prefixes=["","-webkit-","-moz-","-o-","-ms-"];for(var i in prefixes){var property=prefixes[i]+pProperty;if(document.body.style[property]!==undefined){return property}else{l(property+" not supported")}}}function filterInitialValueSet(pProperty,applyToElement){var propertyWithoutFilterPrefix=pProperty.substr(6).toLowerCase();var DEFAULTS={blur:"0px",brightness:"100%",contrast:"100%",grayscale:"0%","hue-rotate":"0deg",invert:"0%",saturate:"100%",sepia:"0%"};var value=0;if(propertyWithoutFilterPrefix in DEFAULTS){value=DEFAULTS[propertyWithoutFilterPrefix]}var value=filterTweenPropertyObjectGet(pProperty,value);TweenMax.set(applyToElement,value)}
gRowLoadedCallbacks=[];$(document).ready(function(){l("Image loader ready");allImagesLoadCheck(true);$(".mobileSelectable").each(function(){mobileAnimsInit($(this))});firstRowInit()});function firstRowInit(){var rows=rowWrapperSelectorGet();if(0==rows.length){return}var firstRow=rows.eq(0);firstRowStaggeredImageLoadCheck();var faded=firstRow.attr("data-fadedIn");if(!faded){l("Still waiting for first row to fade in - registering callback");gFirstRowFadeCallbacks.push(firstRowFadedCallback)}else{l("First row already faded - executing callback immediately");firstRowFadedCallback()}}function firstRowFadedCallback(){var rows=rowWrapperSelectorGet();var firstRow=rows.eq(0);rowFadedCallback(firstRow)}function allImagesLoadCheckAll(pAllImagesLoadedCallback){allImagesLoadCheck(false,pAllImagesLoadedCallback)}function editorLoaded(){return typeof gEditorLoaded!=="undefined"}function allImagesLoadCheck(pOmitFirst,pAllImagesLoadedCallback){if(editorLoaded()){$(".rootRowWrapper").each(function(){var wrapper=$(this);if(0==wrapper.css("opacity")&&!wrapper.hasClass("ignoreFade")){wrapper.css("opacity",1)}rowAnimsInit(wrapper)});if(!mobileLayout()){var interval=null;imagesLoadCheck(rowWrapperSelectorGet(),false,function(){if(allImagesAreLoaded(rowWrapperSelectorGet())){if(interval){clearInterval(interval)}if("undefined"!=typeof rolloversRefresh){interval=setTimeout(rolloversRefresh,1e3)}pAllImagesLoadedCallback&&pAllImagesLoadedCallback()}})}else{imagesLoadCheck($(".mobileLayout"),false,function(){if(allImagesAreLoaded(menuLayoutSelectorGet())){pAllImagesLoadedCallback&&pAllImagesLoadedCallback()}});firstMobileElementFadeIn()}}else{if(!mobileLayout()){nextRowLoad(pOmitFirst)}else{var mobileImages=$(".mobileLayout").find("[data-imageSrc]");mobileStaggeredImageLoadCheck();if(pOmitFirst){mobileImages=$(".mobileSelectable").slice(1).find("[data-imageSrc]")}else{firstMobileElementFadeIn()}if(0==mobileImages.length){return}mobileImages.each(function(){var image=$(this);if(!image.data("loaded")){image.css("opacity",0)}});imagesLoadCheck(mobileImages,false,function(pLoadedElement){if(!pLoadedElement){return}var parent=domClimbTo(pLoadedElement,".mobileSelectable");if(parent&&0==parent.css("opacity")){l("Fading in element parent");pLoadedElement.css("opacity",1);if(!parent.hasClass("opacityZeroRemove")){TweenLite.to(parent,.5,{opacity:1})}}else{l("*** Fading in image ***");TweenLite.to(pLoadedElement,.5,{opacity:1})}})}}}function firstMobileElementFadeIn(){var firstElement=$("#mobileElement0");if(firstElement.length>0){if(firstElement.find("data-imageSrc").length==0){TweenLite.to(firstElement,.5,{opacity:1})}}}function unattachedImagesLoad(){}function rowWrapperSelectorGet(pOmitFirst){var selector=currentLayoutSelectorGet().find(".rowWrapper");if(pOmitFirst){selector=selector.slice(1)}var rows=selector.toArray();rows=rows.concat(menuLayoutSelectorGet().find(".rowWrapper").toArray());rows=rows.concat(footerLayoutSelectorGet().find(".rowWrapper").toArray());return $(rows)}var allRowWrappers=null;function nextRowLoad(pOmitFirst){var rowWrappers=rowWrapperSelectorGet(pOmitFirst);var wrappersInViewPort=[];var wrappersOutOfViewPort=[];$.each(rowWrappers,function(pIndex,pElement){var wrapper=$(this);if(elementIsInViewport(wrapper)){wrappersInViewPort.push(pElement)}else{wrappersOutOfViewPort.push(pElement)}});var orderedRowWrappers=wrappersInViewPort.concat(wrappersOutOfViewPort);$.each(orderedRowWrappers,function(pIndex,pRow){var row=$(pRow);if(row.data("loading")){return false}if("fadedIn"==row.data("FADE_STATE")||"fadingIn"==row.data("FADE_STATE")){return true}if(elementIsHidden(row)){return true}rowLoadEventsTrigger(row);if(rowHasNoImages(row)){if(elementIsInViewport(row)){rowFadeIn(row,function(){nextRowLoad(pOmitFirst)})}else{rowFadeIn(row);nextRowLoad(pOmitFirst)}return false}row.data("loading",true);imagesLoadCheck(row,false,function(){if(allImagesAreLoaded(row)){rowFadeCheck(row,pOmitFirst)}});return false})}function rowFadeCheck(pRow,pOmitFirst){if(elementIsInViewport(pRow)){rowFadeIn(pRow);setTimeout(function(){pRow.data("loading",false);nextRowLoad(pOmitFirst)},100)}else{rowFadeIn(pRow);pRow.data("loading",false);nextRowLoad(pOmitFirst)}}function rowLoadEventsTrigger(pRowWrapper){rowLoadedCallbacksExecute();var elements=pRowWrapper.find(".block");if(elements.length>0){elements.each(function(){var element=$(this);if(element.data("rowLoadEvent")){element.data("rowLoadEvent")();element.removeData()}})}}function rowHasNoImages(pRowWrapper){var columns=pRowWrapper.find(".flexColumn");var visibleColumns=columns.filter(function(){return!elementIsHidden($(this))});var clonedWrapper=pRowWrapper.clone();clonedWrapper.remove(".flexColumn");var wrapperPlusColumns=clonedWrapper.add(visibleColumns);return imagesSelectorGet(wrapperPlusColumns).length==0}function rowFadedCallback(pRowWrapper){if("undefined"!=typeof overlaysAddToRow){overlaysAddToRow(pRowWrapper)}rowAnimsInit(pRowWrapper);rowScrollingUpdate()}function lastRowLoadedCallback(){l("lastRowLoadedCallback");pageHeightCalculate()}function allRowsAreLoaded(){var rows=allRootRowWrappersSelectorGet().slice(1);var allRowsLoaded=true;$.each(rows,function(){var row=$(this);if(!rowIsLoaded(row)){allRowsLoaded=false}else{}});return allRowsLoaded}function rowIsLoaded(pRow){return"fadingIn"===pRow.data("FADE_STATE")||"fadedIn"===pRow.data("FADE_STATE")}function rowFadeIn(pRowWrapper,pCallback){pRowWrapper.data("FADE_STATE","fadingIn");if(allRowsAreLoaded()){lastRowLoadedCallback()}var fadeTime=.5;if(pRowWrapper.hasClass("noFade")){fadeTime=0}var timeline=new TimelineLite({onComplete:function(){pRowWrapper.data("FADE_STATE","fadedIn");rowFadedCallback(pRowWrapper);pCallback&&pCallback()}});if(pRowWrapper.hasClass("ignoreFade")){pRowWrapper.data("FADE_STATE","fadedIn");rowFadedCallback(pRowWrapper);pCallback&&pCallback();return}timeline.to(pRowWrapper,fadeTime,{opacity:1})}function srcGet(pImage){var imageSrc=pImage.attr("src");if(!imageSrc){imageSrc=pImage.css("background-image")}return imageSrc}function allImagesAreLoaded(pSelector){var allLoaded=true;var imageCount=0;imagesSelectorGet(pSelector).each(function(){var element=$(this);var loaded=element.data("loaded");var hidden=elementIsHidden(element);var ignore=element.data("loader-ignore");if("ignore"!=element.data("loader-ignore")&&!elementIsHidden(element)&&!element.data("loaded")){allLoaded=false}else{imageCount++}});if(allLoaded){}else{}return allLoaded}function imagesSelectorGet(pContainers){var selector=pContainers.find("[data-imageSrc]");pContainers.each(function(){var container=$(this);if(container.is("[data-imageSrc]")){selector=selector.add(container)}});return selector}function imagesLoadCheck(pSelector,pCheckViewPort,pImageLoadedCallback){if(allImagesAreLoaded(pSelector)){pImageLoadedCallback&&pImageLoadedCallback();return}var selector=imagesSelectorGet(pSelector);selector.each(function(){var element=$(this);if(element.data("loaded")){return}if(elementIsHidden(element)){l("Element is hidden");return}if(pCheckViewPort&&!elementIsInViewport(element)){return}imageLoad(element,"data-imageSrc",pImageLoadedCallback)})}function imageLoadCallbackRegister(pImageElement,pCallback){var imageData=earlyLoadImageDataGetFromId(pImageElement.attr("id"));if(imageData){if(imageData.loaded){pCallback()}else{imageData.callbacks.push(function(){pCallback()})}}else{if(pImageElement.data("loaded")){pCallback()}else{pImageElement.data("imageLoadedCallback",pCallback)}}}function rowLoadedCallbackRegister(pCallback){gRowLoadedCallbacks.push(pCallback)}function rowLoadedCallbacksExecute(){$.each(gRowLoadedCallbacks,function(pIndex,pCallback){pCallback()})}function imageLoadedCallbackTrigger(pImageElement){if(pImageElement.data("imageLoadedCallback")){pImageElement.data("imageLoadedCallback")(pImageElement);pImageElement.removeData("imageLoadedCallback")}}function imageLoaded(pImageElement,pImageLoadedCallback){pImageElement.data("loaded",true);pImageLoadedCallback&&pImageLoadedCallback(pImageElement);imageLoadedCallbackTrigger(pImageElement);staggeredImageLoadCheck(pImageElement)}function imageIsLoaded(pImage){return pImage.data("loaded")}function imageLoad(pImageElement,pDataAttribute,pImageLoadedCallback){var url=pImageElement.attr(pDataAttribute);if(pImageElement.is("img")){if(-1!=url.indexOf("data:image/jpeg;base64")){pImageElement.data("loaded",true);pImageElement.css("padding-bottom",0);l("image is not url but actual data - temp fix to ignore");imageLoaded(pImageElement,pImageLoadedCallback);return}l("Loading Image: "+url);l("Already loaded",pImageElement.data("loaded"));pImageElement.on("load",function(){if(pImageElement.data("loaded")){l("alreadyLoaded");return}pImageElement.css("padding-bottom",0);imageLoaded(pImageElement,pImageLoadedCallback)});pImageElement.attr("src",url)}else{l("Loading background image: "+url);var dummyImage=$('<img src="'+url+'" >');dummyImage.on("load",function(){if(pImageElement.data("loaded")){pImageLoadedCallback&&pImageLoadedCallback();return}pImageElement.css("background-image","url("+url+")");l("Background Image Loaded: "+url);imageLoaded(pImageElement,pImageLoadedCallback)})}}function mobileStaggeredImageLoadCheck(){var staggeredImages=$(".mobileLayout").find("[data-image-src-staggered]");if(staggeredImages.length>0){staggeredImageLoadCheck(staggeredImages.eq(0))}}function firstRowStaggeredImageLoadCheck(){var rows=rowWrapperSelectorGet();var firstRow=rows.eq(0);var staggeredImages=firstRow.find("[data-image-src-staggered]");if(staggeredImages.length>0){staggeredImageLoadCheck(staggeredImages.eq(0))}}function staggeredImageLoadCheck(pTriggerImage){var elementRoot=domClimbTo(pTriggerImage,".selectable,.mobileSelectable");if(!elementRoot){elementRoot=pTriggerImage}var staggeredImages=elementRoot.find("[data-image-src-staggered]");if(0==staggeredImages.length){return}if(staggeredImages.get(0).hasAttribute("data-staggered-reverse")){staggeredImages=staggeredImages.reverse()}staggeredImages.each(function(pImage){var staggeredImage=$(this);if(!staggeredImage.data("loaded")){var delay=staggeredImage.attr("data-image-load-delay");delay=delay?delay:0;l("Loading staggered image in "+delay*1e3);setTimeout(function(){l("Loading Staggered Image "+staggeredImage.data("image-src-staggered"));imageLoad(staggeredImage,"data-image-src-staggered")},delay*1e3);return false}})}
var NUMBER_COUNT_TIME_MS=3e3;var SLIDE_SELECTOR=".slideFromLeft,.slideFromRight,.slideFromTop,.slideFromBottom,.slideFromTopRight,.slideFromTopLeft,.slideFromBottomLeft,.slideFromBottomRight";var ROTATE_SELECTOR=".rotateClockwise,.rotateAntiClockwise";var GROW_SELECTOR=".grow";var COUNTER_SELECTOR=".counter";var FADE_SELECTOR=".fade";var DRAWSVG_SELECTOR=".drawSVG";$(document).ready(function(){countersInit()});function animStartCallbackRegister(pElement,pCallback){pElement.data("animStartCallback",pCallback)}function animCompleteCallbackRegister(pElement,pCallback){pElement.data("animCompleteCallback",pCallback)}function hasSpecificAnim(pElement){var selectors=[SLIDE_SELECTOR,ROTATE_SELECTOR,GROW_SELECTOR,COUNTER_SELECTOR,FADE_SELECTOR,DRAWSVG_SELECTOR];return pElement.is(selectors.join(","))}function allAnimsReset(){allRootRowWrappersSelectorGet().data("initialized",false);rowAnimsInit(allRootRowWrappersSelectorGet())}function rowAnimsInit(pRowWrapper){if(pRowWrapper.data("initialized")){return}pRowWrapper.data("initialized",true);animGroupInit(pRowWrapper,SLIDE_SELECTOR,slideAnimTrigger);animGroupInit(pRowWrapper,ROTATE_SELECTOR,rotateAnimTrigger);animGroupInit(pRowWrapper,GROW_SELECTOR,growAnimTrigger);animGroupInit(pRowWrapper,DRAWSVG_SELECTOR,drawSVGAnimTrigger);if("undefined"!=typeof numberCountStart){animGroupInit(pRowWrapper,COUNTER_SELECTOR,numberCountStart)}animGroupInit(pRowWrapper,FADE_SELECTOR,fadeAnimTrigger);defaultStaggeredFadeInit(pRowWrapper)}function mobileAnimsInit(pElement){if("undefined"!=typeof numberCountStart){animGroupInit(pElement,COUNTER_SELECTOR,numberCountStart)}}function defaultStaggeredFadeInit(pRowWrapper){var startTime=0;var timeline=new TimelineLite;if(pRowWrapper.is(".noFade,.ignoreFade")){pRowWrapper.find(".layoutSquare.hasImage").css("opacity",1);return}pRowWrapper.find(".layoutSquare.hasImage").each(function(){var element=$(this);if(editorLoaded()&&domClimbTo(element,".block-superCarousel")){element.css("opacity",1);return true}if(element.is(".noFade")){return true}if(hasElementOpacityEffect(element)){return true}if(!hasSpecificAnim(element)){timeline.to(element,1,{opacity:1},startTime);startTime+=.2}})}function countersInit(){$(".counter").each(function(){var element=$(this);var numberText=element.text();while(-1!=numberText.indexOf(",")){numberText=numberText.replace(",","")}var initialValue=parseInt(numberText);if(initialValue){element.data("number",initialValue);element.text("0")}})}function animGroupInit(pElement,pSelector,pTriggerFunction){var elements=pElement.find(pSelector);if(pElement.is(pSelector)){elements=elements.add(pElement)}elements.each(function(){var element=$(this);if(element.is(".onLoad")){pTriggerFunction(element)}else{if(!element.data("intervalActive")){var interval=setInterval(function(){if(elementIsInViewport(element.parent(),.33)){l("Trigger! "+element.attr("class"));pTriggerFunction(element);clearInterval(interval)}},500);element.data("intervalActive",true)}}})}function baseTweenPropertiesGet(pElement){var properties={delay:0,opacity:targetOpacityGet(pElement),onStart:function(){if(pElement.data("animStartCallback")){pElement.data("animStartCallback")()}},onComplete:function(){if(pElement.data("animCompleteCallback")){pElement.data("animCompleteCallback")()}}};if(pElement.data("anim-delay")){l("Anim Delay !!!",pElement.data("anim-delay"));properties.delay=pElement.data("anim-delay")}$.each(gEASES,function(pKey,pEase){if(pElement.is("."+pKey)){properties.ease=pEase}});if(!("ease"in properties)){properties.ease=Power1.easeOut}return properties}function fadeAnimTrigger(pElement){l("Fading",pElement.attr("id"));var properties=baseTweenPropertiesGet(pElement);TweenLite.to(pElement,.5,properties)}function growAnimTrigger(pElement){l("grow");l(pElement.css("opacity"));l(pElement.css("visibility"));var properties=baseTweenPropertiesGet(pElement);properties.scale=1;TweenLite.to(pElement,.5,properties)}function drawSVGAnimTrigger(pElement,pOnComplete,pDelayOverride){var properties=baseTweenPropertiesGet(pElement);var delay=dp(pDelayOverride,properties.delay);var DURATION=1.5;var STAGGER_DELAY=.2;var paths=pElement.find("path,line,polyline,polygon,rect,ellipse");pElement.css("opacity",1);var EASE=properties.ease;var onComplete={};if(pOnComplete){onComplete={onComplete:pOnComplete}}var delayProperty={delay:delay};var onCompleteAndDelay=$.extend(onComplete,delayProperty);if(pElement.hasClass("alternate")){var oddPaths=paths.filter(":odd");var evenPaths=paths.filter(":even");var oddTimeline=new TimelineLite(onCompleteAndDelay);var evenTimeline=new TimelineLite(delayProperty);oddTimeline.staggerFrom(oddPaths,DURATION,{drawSVG:"0% 0%",ease:EASE,opacity:0},STAGGER_DELAY);evenTimeline.staggerFrom(evenPaths,DURATION,{drawSVG:"100% 100%",ease:EASE,opacity:0},STAGGER_DELAY)}else{var timeline=new TimelineLite(onCompleteAndDelay);if(pElement.hasClass("reverse")){timeline.staggerFrom(paths,DURATION,{drawSVG:"100% 100%",ease:EASE,opacity:0},STAGGER_DELAY)}else{timeline.staggerFrom(paths,DURATION,{drawSVG:"0%",ease:EASE,opacity:0},STAGGER_DELAY)}}}function rotateAnimTrigger(pElement){var properties=baseTweenPropertiesGet(pElement);properties.rotationZ=360;if(pElement.is(".rotateAntiClockwise")){properties.rotationZ=-360}TweenLite.to(pElement,.5,properties)}function slideAnimTrigger(pElement){var properties=baseTweenPropertiesGet(pElement);properties.x=0;properties.y=0;TweenLite.to(pElement,.5,properties)}function targetOpacityGet(pElement){return 1}
gCarouselsPaused=false;$(document).ready(function(){$(window).focus(function(){carouselReset();l("focus")});$(window).blur(function(){allCarouselsStop();l("blur")})});function carouselStripImageLoadCheck(pBlock){var imageWrapper=pBlock.find(".carouselImageWrapper");var strip=pBlock.find(".carouselStripWrapper");var images=strip.find(".carouselStripThumbnail");$(images).each(function(pIndex){var stripImage=$(this);stripImage.css("opacity",0);var index=stripImage.data("index");var carouselImage=imageWrapper.find(".carouselImage").eq(pIndex);var dataAttr="image-src-staggered";var src=carouselImage.data(dataAttr);if(!src){dataAttr="imagesrc";src=carouselImage.data(dataAttr)}imageLoadCallbackRegister(carouselImage,function(){l("loaded strip image "+pIndex);stripImage.css("background-image","url("+src+")");TweenMax.to(stripImage,.5,{opacity:1})})})}function carouselStripInit(pCarouselStrip){l("Carousel strip init");var block=domClimbTo(pCarouselStrip,".block-carousel");var imageWrapper=block.find(".carouselImageWrapper");pCarouselStrip.data("first",0);pCarouselStrip.find(".carouselStripThumbnail,.navButton").unbind();carouselStripImageLoadCheck(block);var stripImages=pCarouselStrip.find(".carouselStripThumbnail");$(stripImages).click(function(pIndex){var image=$(this);stripImages.removeClass("selected");image.addClass("selected");var index=image.data("index");carouselManualSlideToPos(imageWrapper,index)});var nextButton=pCarouselStrip.find(".nextButton");var prevButton=pCarouselStrip.find(".previousButton");carouselThumbnailStripNavButtonsActiveSet(pCarouselStrip);$(nextButton).click(function(pIndex){var button=$(this);var oldFirst=pCarouselStrip.data("first");var visibleItems=pCarouselStrip.data("strip-items");var totalItems=stripImages.length;var maxFirst=Math.max(0,totalItems-visibleItems);var newFirst=Math.min(oldFirst+visibleItems,maxFirst);carouselThumbnailStripPosSet(pCarouselStrip,newFirst);carouselThumbnailStripNavButtonsActiveSet(pCarouselStrip)});$(prevButton).click(function(pIndex){var button=$(this);var oldFirst=pCarouselStrip.data("first");var visibleItems=pCarouselStrip.data("strip-items");var totalItems=stripImages.length;var newFirst=oldFirst-visibleItems;newFirst=Math.max(0,newFirst);carouselThumbnailStripPosSet(pCarouselStrip,newFirst);carouselThumbnailStripNavButtonsActiveSet(pCarouselStrip)})}function carouselManualSlideToPos(pWrapper,pPos){carouselAnimateToPos(pWrapper,pPos);carouselAutoSlideStop(pWrapper)}function carouselThumbnailStripNavButtonsActiveSet(pStrip){var first=pStrip.data("first");var visibleItems=pStrip.data("strip-items");var images=pStrip.find(".carouselStripThumbnail");var totalItems=images.length;var maxFirst=Math.max(0,totalItems-visibleItems);var prevButton=pStrip.find(".previousButton");var nextButton=pStrip.find(".nextButton");prevButton.removeClass("disabled");nextButton.removeClass("disabled");if(first==0){prevButton.addClass("disabled")}if(first>=maxFirst){nextButton.addClass("disabled")}}function carouselThumbnailStripPosSet(pCarouselStrip,pFirstIndex){var visibleItems=pCarouselStrip.data("strip-items");var images=pCarouselStrip.find(".carouselStripThumbnail");$(images).each(function(pIndex){var image=$(this);if(pIndex>=pFirstIndex&&pIndex<pFirstIndex+visibleItems){image.show()}else{image.hide()}});pCarouselStrip.data("first",pFirstIndex)}function carouselAutoSlideStop(pImageWrapper){clearInterval(pImageWrapper.data("intervalId"))}function imageCarouselStripsInit(){var strips=$(".block-carousel .carouselStripWrapper");$(strips).each(function(pIndex){carouselStripInit($(this))})}function imageCarouselsDotsInit(){$(".block-carousel").each(function(){imageCarouselDotsInit($(this))})}function imageCarouselDotsInit(pBlock){l("imageCarouselDotsInit",pBlock.attr("id"));var dots=pBlock.find(".carouselDot");dots.unbind();dots.click(function(){var dot=$(this);var imageWrapper=dot.parent().parent().find(".carouselImageWrapper");var index=dot.prevAll().length;carouselAnimateToPos(imageWrapper,index);carouselAutoSlideStop(imageWrapper)});var images=pBlock.find(".carouselImage");$(images).each(function(pImageIndex){var image=$(this);l("dots registering callback for "+pImageIndex);imageLoadCallbackRegister(image,function(){l("Dots check - image loaded "+pImageIndex);dots.eq(pImageIndex).data("activated",true);$(dots).each(function(pDotIndex){var dot=$(this);if(dot.data("activated")){if(!dot.data("faded")){TweenMax.to(dot,.5,{opacity:1});dot.data("faded",true)}return true}return false})})})}function allCarouselsStop(){var imageWrappers=$(".block-carousel .carouselImageWrapper");imageWrappers.each(function(){clearInterval(imageWrappers.data("intervalId"))})}function carouselReset(){var imageWrappers=$(".block-carousel .carouselImageWrapper");if(0==imageWrappers.length){return}imageWrappers.each(function(){var wrapper=$(this);var tween=wrapper.data("tween");if(tween){tween.kill();wrapper.removeData("tween")}});TweenLite.set(imageWrappers,{x:0});carouselsInit()}function carouselsInit(){imageCarouselsDotsInit();imageCarouselStripsInit();var imageWrappers=$(".block-carousel .carouselImageWrapper");imageWrappers.each(function(){var wrapper=$(this);wrapper.data("imageCount",wrapper.find(".carouselImage").length);wrapper.data("pos",0);carouselNextPrevButtonsInit(wrapper)});imageWrappers.each(function(){var wrapper=$(this);var intervalTimeMs=wrapper.attr("data-interval")*1e3;intervalTimeMs+=wrapper.attr("data-duration")*1e3;var previousInterval=wrapper.data("intervalId");if(previousInterval){clearInterval(previousInterval)}var interval=setInterval(function(){if(timeSinceLastScrollMsGet()<1e3){return}var images=wrapper.find(".carouselImage");var nextImageIndex=wrapper.data("pos")+1;if(nextImageIndex==images.length){nextImageIndex=0}var nextImage=images.eq(nextImageIndex);if(imageIsLoaded(nextImage)){console.log("Image loaded - animating");carouselAnimateToPos(wrapper,wrapper.data("pos")+1)}else{console.log("Image not loaded - will try again soon")}},intervalTimeMs);wrapper.data("intervalId",interval)})}function carouselNextPrevButtonsInit(pWrapper){var block=pWrapper.parent();block.find(".leftRightButton").unbind();block.find(".leftButton").click(function(){carouselManualSlideToPos(pWrapper,pWrapper.data("pos")-1)});block.find(".rightButton").click(function(){carouselManualSlideToPos(pWrapper,pWrapper.data("pos")+1)})}function carouselAnimateToPos(pImageWrapper,pPos){var duration=pImageWrapper.data("duration");var dots=pImageWrapper.parent().parent().find(".carouselDot");dots.removeClass("current");var width=pImageWrapper.width();var images=pImageWrapper.find(".carouselImage");if(pPos==images.length){pImageWrapper.append(images.eq(0).clone(true,true));images=pImageWrapper.find(".carouselImage");dots.eq(0).addClass("current")}else{dots.eq(pPos).addClass("current")}var image=images.eq(pPos);var translation=image.position().left+image.width()*.01;l("position",image.position().left);l("offset",image.offset().left);var tween=TweenLite.to(pImageWrapper,duration,{x:-translation,onComplete:function(){var imageCount=pImageWrapper.data("imageCount");if(images.length>imageCount){images.slice(imageCount).remove();TweenLite.set(pImageWrapper,{x:0});pImageWrapper.data("pos",0)}pImageWrapper.removeData("tween")}});pImageWrapper.data("pos",pPos);pImageWrapper.data("tween",tween)}
var gLastSuperCarouselWidth=null;function superCarouselBlocksInit(){forEachSuperCarouselBlockInCurrentLayout(function(pBlock){superCarouselBlockInit(pBlock)});gLastSuperCarouselWidth=$("html").width()}function superCarouselBlocksInCurrentLayoutGet(){return currentLayoutSelectorGet().find(".selectable.block-superCarousel")}function allSuperCarouselBlocksGet(){return $(".selectable.block-superCarousel")}function forEachSuperCarouselBlock(pCallback){allSuperCarouselBlocksGet().eachElement(function(pBlock){return pCallback(pBlock)})}function forEachSuperCarouselBlockInCurrentLayout(pCallback){superCarouselBlocksInCurrentLayoutGet().eachElement(function(pBlock){return pCallback(pBlock)})}function superCarouselsResize(){l("superCarouselsResize");if(gLastSuperCarouselWidth==$("html").width()){return}superCarouselBlocksInit()}function superCarouselDotCurrentSet(pBlockElement,pIndex){var dots=pBlockElement.find(".carouselDot");dots.removeClass("current");dots.eq(pIndex).addClass("current")}function superCarouselDotsInit(pBlockElement){var dots=pBlockElement.find(".carouselDot");if(0==dots.length){return}dots.unbind();dots.click(function(){var dot=$(this);var index=dot.prevAll().length;superCarouselSlideIntervalClear(pBlockElement);superCarouselAnimateToIndex(pBlockElement,index)})}function superCarouselSlideIntervalClear(pBlockElement){var interval=pBlockElement.data("slideInterval");if(interval){l("Clearing slide interval");clearInterval(interval);pBlockElement.removeData("slideInterval")}}function superCarouselSlideWidthGet(pBlockElement){var borderContainer=pBlockElement.find(".blockBorderContainer");var slideWidth=borderContainer.width();return slideWidth}function superCarouselBlockHtmlStoreCheck(pBlockElement){var html=pBlockElement.data("html");if(html){superCarouselSlideIntervalClear(pBlockElement);pBlockElement.html(html);pBlockElement.removeData();pBlockElement.data("html",html);return}else{l("Not yet initialized - storing original html");pBlockElement.data("html",pBlockElement.html())}}function superCarouselBlockInit(pBlockElement){superCarouselBlockHtmlStoreCheck(pBlockElement);var elementsWrapper=pBlockElement.find(".superCarouselElementsWrapper");var innerWrapper=pBlockElement.find(".superCarouselInnerWrapper");var slideWidth=superCarouselSlideWidthGet(pBlockElement);l("Slide Width 1",slideWidth);var clonedSlides=elementsWrapper.find(".superCarouselElement").clone();if(0==clonedSlides.length){return}clonedSlides.eachIndexAndElement(function(pIndex,pElement){pElement.attr("data-index",pIndex)});elementsWrapper.empty();var initialSlideCount=clonedSlides.length;if(0==initialSlideCount){return}var screenToSlideRatio=$("html").width()/slideWidth;var slidesOnScreen=Math.floor(screenToSlideRatio)+2;var minSlides=Math.max(slidesOnScreen*4,initialSlideCount*4);l("Min Slides!!!",minSlides);l("Cloning superCarousel elements",minSlides);var loop=0;while(elementsWrapper.find(".superCarouselElement").length<minSlides){clonedSlides.each(function(){var slide=$(this);var clonedSlide=slide.clone();if(loop>0){var backgroundImage=clonedSlide.find(".backgroundImage");var layoutSquare=clonedSlide.find(".layoutSquare");layoutSquare.attr("data-id",layoutSquare.attr("data-id")+"-"+loop);backgroundImage.attr("id",backgroundImage.attr("id")+"-"+loop)}elementsWrapper.append(clonedSlide)});loop++}innerWrapper.css("width",slideWidth);var slides=elementsWrapper.find(".superCarouselElement");slides.width(slideWidth);pBlockElement.css("height",pBlockElement.height());innerWrapper.css("width","auto");slides.remove();var newSlideWidth=superCarouselSlideWidthGet(pBlockElement);if(slideWidth!=newSlideWidth){l(slideWidth+" changed to "+newSlideWidth)}elementsWrapper.append(slides);slides.css("width",newSlideWidth);innerWrapper.css("width",newSlideWidth);pBlockElement.css("height","auto");l(innerWrapper.css("height"));if(""!=innerWrapper.css("height")){slides.find(".borderContainer").children().css("height",innerWrapper.css("height"))}var pos=initialSlideCount*2;pBlockElement.data("pos",pos);pBlockElement.data("index",0);pBlockElement.data("initialSlideCount",initialSlideCount);pBlockElement.data("slideWidth",newSlideWidth);imagesLoadCheck(pBlockElement,false,function(){l("Super Carousel image loaded inform")});superCarouselImagesLoadCheck(pBlockElement,function(){var mobile=domClimbTo(pBlockElement,".mobileSelectable");if(mobile&&0==mobile.css("opacity")){l("opacityZero flag used to prevent flash from early load");TweenMax.to(mobile,.5,{opacity:1})}superCarouselAnimsInit(pBlockElement,initialSlideCount);superCarouselDotsInit(pBlockElement);pBlockElement.find(".layoutSquare.hasImage,.backgroundImage").each(function(){var image=$(this);if(1!=image.css("opacity")){l("Image found with 0 opacity - fading in");TweenMax.to(image,.5,{opacity:1})}});if(editorLoaded()){selectionInit()}})}function superCarouselSrcSetForIndex(pBlockElement,pIndex,pUrl){var slides=pBlockElement.find(".superCarouselElement");slides.eachElement(function(pElement){if(pElement.data("index")==pIndex){var image=pElement.find(".fluidHeightRowImage");var backgroundImage=pElement.find(".backgroundImage");l("src",image.attr("src"));l("padding-bottom",image.css("padding-bottom"));if(image.length>0){image.attr("src",pUrl);image.css("padding-bottom","");l("Setting src for "+pIndex)}else if(backgroundImage.length>0&&"none"==backgroundImage.css("background-image")){l("Setting background image for "+pIndex);backgroundImage.css("background-image",pUrl)}}})}function superCarouselImagesLoadCheck(pBlockElement,pCallback){var slides=pBlockElement.find(".superCarouselElement");var allLoaded=true;slides.eachElement(function(pSlideElement){var loaded=superCarouselImageLoadCheck(pSlideElement);if(!loaded){allLoaded=false}});if(allLoaded){l("All loaded");pCallback()}else{l("Not yet loaded");var interval=setTimeout(function(){superCarouselImagesLoadCheck(pBlockElement,pCallback)},1e3)}}function superCarouselImageLoadCheck(pSlideElement){var image=pSlideElement.find(".fluidHeightRowImage");var backgroundImage=pSlideElement.find(".backgroundImage");var index=pSlideElement.data("index");var block=domClimbTo(pSlideElement,".block-superCarousel");if(1==image.length){if(image[0].hasAttribute("src")){superCarouselSrcSetForIndex(block,index,image.attr("src"));image.data("loaded",true);return true}else{return false}}else if(1==backgroundImage.length){l("Background Image",backgroundImage.css("background-image"));if("none"!=backgroundImage.css("background-image")){superCarouselSrcSetForIndex(block,index,backgroundImage.css("background-image"));pSlideElement.data("loaded",true);return true}else{return false}}return true}function superCarouselPosSet(pBlockElement,pPos){pBlockElement.data("pos",pPos);superCarouselWrapperPositionSet(pBlockElement)}function superCarouselWrapperPositionSet(pBlockElement){var pos=pBlockElement.data("pos");var slideWidth=pBlockElement.data("slideWidth");var x=pos*slideWidth;var elementsWrapper=pBlockElement.find(".superCarouselElementsWrapper");TweenMax.set(elementsWrapper,{x:-x});l("Setting pos to "+pos+" and x to "+x)}function superCarouselAnimsInit(pBlockElement,pInitialSlideCount){l("superCarouselAnimsInit");superCarouselWrapperPositionSet(pBlockElement);var forward=true;var slideFunction=function(){var pos=pBlockElement.data("pos");var index=pBlockElement.data("index");var newIndex=forward?index+1:index-1;if("loop"==data.loop&&newIndex>=pInitialSlideCount){newIndex=0}var newPos=forward?pos+1:pos-1;superCarouselAnimateToPos(pBlockElement,newPos,newIndex,function(){slideTimeoutSet(pBlockElement,slideFunction);if("reverse"==data.loop){var endIndex=pInitialSlideCount-1;if(!isNaN(data.reverseAt)){endIndex=data.reverseAt}if(forward&&newIndex==endIndex||!forward&&0==newIndex){forward=!forward}}})};slideTimeoutSet(pBlockElement,slideFunction)}function slideTimeoutSet(pBlockElement,pSlideFunction){var data=elementDataGet(pBlockElement);var intervalMs=parseFloat(data.slideInterval)*1e3;var interval=setTimeout(pSlideFunction,intervalMs);pBlockElement.data("slideInterval",interval)}function superCarouselAnimateToIndex(pBlockElement,pIndex){var currentIndex=pBlockElement.data("index");var currentPos=pBlockElement.data("pos");if(pIndex>currentIndex){var moveForwardBy=pIndex-currentIndex;var newPos=currentPos+moveForwardBy}else if(pIndex<currentIndex){var moveBackBy=currentIndex-pIndex;var newPos=currentPos-moveBackBy}superCarouselAnimateToPos(pBlockElement,newPos,pIndex)}function superCarouselAnimateToPos(pBlockElement,pPos,pIndex,pOnComplete){var moving=pBlockElement.data("moving");if(moving){return}var slideWidth=pBlockElement.data("slideWidth");var elementsWrapper=pBlockElement.find(".superCarouselElementsWrapper");var slides=elementsWrapper.find(".superCarouselElement");var data=elementDataGet(pBlockElement);pBlockElement.data("moving",true);superCarouselDotCurrentSet(pBlockElement,pIndex);var currentPos=pBlockElement.data("pos");var slideCount=slides.length;var halfSlideCount=slideCount/2;var initialSlideCount=pBlockElement.data("initialSlideCount");if(pPos>currentPos){if(pPos>halfSlideCount){l("Moving back");superCarouselPosSet(pBlockElement,currentPos-initialSlideCount);pPos-=initialSlideCount}}var x=slideWidth*pPos;TweenMax.to(elementsWrapper,parseFloat(data.slideDuration),{x:-x,onComplete:function(){pBlockElement.data("pos",pPos);pBlockElement.data("index",pIndex);pOnComplete&&pOnComplete();pBlockElement.data("moving",false)}})}